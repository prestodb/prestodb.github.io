

<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="hudi.html">
      
      
        <link rel="next" href="jmx.html">
      
      
      <link rel="icon" href="../_static/favicon.ico">
    
    
      
        <title>Iceberg Connector - Presto 0.295 Documentation</title>
      
    
    
      
        
      
      


    
    
      
    
    
      
        
        
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
        <link rel="stylesheet" type="text/css" href="../_static/sphinx_immaterial_theme.14a9c4ab4f1ea5d49.min.css?v=1031fc17" />
        <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-K7GB6F0LBZ"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-K7GB6F0LBZ",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-K7GB6F0LBZ",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="cyan">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#overview" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="Presto 0.295 Documentation" class="md-header__button md-logo" aria-label="Presto 0.295 Documentation" data-md-component="logo">
      <img src="../_static/logo.png" alt="logo">
    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Presto 0.295 Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Iceberg Connector
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="cyan"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="light-blue" data-md-color-accent="deep-orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/prestodb/presto" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    Presto
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="Presto 0.295 Documentation" class="md-nav__button md-logo" aria-label="Presto 0.295 Documentation" data-md-component="logo">
      <img src="../_static/logo.png" alt="logo">
    </a>
    Presto 0.295 Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/prestodb/presto" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    Presto
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../overview.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../clients.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Clients
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../security.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Security
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../admin.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Administration
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../cache.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cache
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../optimizer.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Query Optimizer
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../connector.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Connectors
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_8" id="__nav_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Connectors
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="accumulo.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Accumulo Connector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="base-arrow-flight.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Arrow Flight Connector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="bigquery.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Big<wbr>Query Connector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="blackhole.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Black Hole Connector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="cassandra.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cassandra Connector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="clickhouse.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Click<wbr>House connector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="deltalake.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Delta Lake Connector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="druid.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Druid Connector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="elasticsearch.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Elasticsearch Connector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="googlesheets.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Google Sheets connector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="hana.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HANA Connector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="hive.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hive Connector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="hive-security.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hive Security Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="hudi.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hudi Connector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Iceberg Connector
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="#" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Iceberg Connector
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary">
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
        <li class="md-nav__item">
            <a href="https://github.com/prestodb/presto/blob/master/presto-docs/src/main/sphinx/connector/iceberg.rst" class="">
                <span class="md-source__icon md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0 8a5 5 0 0 1-5-5 5 5 0 0 1 5-5 5 5 0 0 1 5 5 5 5 0 0 1-5 5m0-12.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5"/></svg>
                </span>
                View Page Source
            </a>
        </li>
        <li class="md-nav__item">
            <a href="https://github.com/prestodb/presto/edit/master/presto-docs/src/main/sphinx/connector/iceberg.rst" class="">
                <span class="md-source__icon md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6 2c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-1.9l10-10V8l-6-6zm7 1.5L18.5 9H13zm7.1 9.5c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-2 1.8L12 20.9V23h2.1l6.1-6.1z"/></svg>
                </span>
                Edit this page
            </a>
        </li>
        <li class="md-nav__item">
            <a href="https://github.com/prestodb/presto/issues/new?title=Documentation&labels=docs"
                class="">
                <span class="md-source__icon md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M40 48c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24h48c13.3 0 24-10.7 24-24V72c0-13.3-10.7-24-24-24zm152 16c-17.7 0-32 14.3-32 32s14.3 32 32 32h288c17.7 0 32-14.3 32-32s-14.3-32-32-32zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32h288c17.7 0 32-14.3 32-32s-14.3-32-32-32zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32h288c17.7 0 32-14.3 32-32s-14.3-32-32-32zM16 232v48c0 13.3 10.7 24 24 24h48c13.3 0 24-10.7 24-24v-48c0-13.3-10.7-24-24-24H40c-13.3 0-24 10.7-24 24m24 136c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24h48c13.3 0 24-10.7 24-24v-48c0-13.3-10.7-24-24-24z"/></svg>
                </span>
                Create docs issue
            </a>
        </li>
        <li class="md-nav__item">
            <a href="https://github.com/prestodb/presto/issues/new" class="">
                <span class="md-source__icon  md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M40 48c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24h48c13.3 0 24-10.7 24-24V72c0-13.3-10.7-24-24-24zm152 16c-17.7 0-32 14.3-32 32s14.3 32 32 32h288c17.7 0 32-14.3 32-32s-14.3-32-32-32zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32h288c17.7 0 32-14.3 32-32s-14.3-32-32-32zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32h288c17.7 0 32-14.3 32-32s-14.3-32-32-32zM16 232v48c0 13.3 10.7 24 24 24h48c13.3 0 24-10.7 24-24v-48c0-13.3-10.7-24-24-24H40c-13.3 0-24 10.7-24 24m24 136c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24h48c13.3 0 24-10.7 24-24v-48c0-13.3-10.7-24-24-24z"/></svg>
                </span>
                Create project issue
            </a>
        </li>
        <li class="md-nav__item">
            <a href="https://communityinviter.com/apps/prestodb/prestodb" class="">
                <span class="md-source__icon  md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M94.12 315.1c0 25.9-21.16 47.06-47.06 47.06S0 341 0 315.1s21.16-47.06 47.06-47.06h47.06zm23.72 0c0-25.9 21.16-47.06 47.06-47.06s47.06 21.16 47.06 47.06v117.84c0 25.9-21.16 47.06-47.06 47.06s-47.06-21.16-47.06-47.06zm47.06-188.98c-25.9 0-47.06-21.16-47.06-47.06S139 32 164.9 32s47.06 21.16 47.06 47.06v47.06zm0 23.72c25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06H47.06C21.16 243.96 0 222.8 0 196.9s21.16-47.06 47.06-47.06zm188.98 47.06c0-25.9 21.16-47.06 47.06-47.06S448 171 448 196.9s-21.16 47.06-47.06 47.06h-47.06zm-23.72 0c0 25.9-21.16 47.06-47.06 47.06s-47.06-21.16-47.06-47.06V79.06c0-25.9 21.16-47.06 47.06-47.06s47.06 21.16 47.06 47.06zM283.1 385.88c25.9 0 47.06 21.16 47.06 47.06S309 480 283.1 480s-47.06-21.16-47.06-47.06v-47.06zm0-23.72c-25.9 0-47.06-21.16-47.06-47.06s21.16-47.06 47.06-47.06h117.84c25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06z"/></svg>
                </span>
                Join PrestoDB on Slack
            </a>
        </li>
    </ul>
    <hr>
    
    
    
    
    
    <label class="md-nav__title" for="__toc">
        <span class="md-nav__icon md-icon"></span>
        Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
        
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:overview (reference label)">Overview</span>
    </span>
  </a>
  
</li>
        
        <li class="md-nav__item">
  <a href="#metastores" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:metastores (reference label)">Metastores</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Metastores">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hive-metastore-catalog" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:hive metastore catalog (reference label)">Hive Metastore catalog</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#file-based-metastore" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:file-based metastore (reference label)">File-<wbr>Based Metastore</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#glue-catalog" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:glue catalog (reference label)">Glue catalog</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nessie-catalog" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:nessie catalog (reference label)">Nessie catalog</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Nessie catalog">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#setting-up-nessie-with-docker" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:setting up nessie with docker (reference label)">Setting Up Nessie With Docker</span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rest-catalog" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:rest catalog (reference label)">REST catalog</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hadoop-catalog" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:hadoop catalog (reference label)">Hadoop catalog</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#presto-c-support" class="md-nav__link">
    
    <span class="md-ellipsis">
      Presto C++ Support
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
        <li class="md-nav__item">
  <a href="#configuration-properties" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:configuration properties (reference label)">Configuration Properties</span>
    </span>
  </a>
  
</li>
        
        <li class="md-nav__item">
  <a href="#table-properties" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:table properties (reference label)">Table Properties</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Table Properties">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deprecated-table-properties" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:deprecated table properties (reference label)">Deprecated Table Properties</span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
        <li class="md-nav__item">
  <a href="#session-properties" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:session properties (reference label)">Session Properties</span>
    </span>
  </a>
  
</li>
        
        <li class="md-nav__item">
  <a href="#caching-support" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:caching support (reference label)">Caching Support</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Caching Support">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#statistics-file-caching" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:statistics file caching (reference label)">Statistics File Caching</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manifest-file-caching" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:manifest file caching (reference label)">Manifest File Caching</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Manifest File Caching">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#id2" class="md-nav__link">
    
    <span class="md-ellipsis">
      Presto C++ Support
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alluxio-data-cache" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:alluxio data cache (reference label)">Alluxio Data Cache</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Alluxio Data Cache">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#id3" class="md-nav__link">
    
    <span class="md-ellipsis">
      Presto C++ Support
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#file-and-stripe-footer-cache" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:file and stripe footer cache (reference label)">File And Stripe Footer Cache</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File And Stripe Footer Cache">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#id4" class="md-nav__link">
    
    <span class="md-ellipsis">
      Presto C++ Support
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metastore-cache" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:metastore cache (reference label)">Metastore Cache</span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
        <li class="md-nav__item">
  <a href="#extra-hidden-metadata-columns" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:extra hidden metadata columns (reference label)">Extra Hidden Metadata Columns</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Extra Hidden Metadata Columns">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#path-column" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:``$path`` column (reference label)">$path column</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-sequence-number-column" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:``$data_sequence_number`` column (reference label)">$data_<wbr>sequence_<wbr>number column</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deleted-column" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:``$deleted`` column (reference label)">$deleted column</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete-file-path-column" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:``$delete_file_path`` column (reference label)">$delete_<wbr>file_<wbr>path column</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#id5" class="md-nav__link">
    
    <span class="md-ellipsis">
      Presto C++ Support
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
        <li class="md-nav__item">
  <a href="#extra-hidden-metadata-tables" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:extra hidden metadata tables (reference label)">Extra Hidden Metadata Tables</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Extra Hidden Metadata Tables">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#properties-table" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:``$properties`` table (reference label)">$properties Table</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#history-table" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:``$history`` table (reference label)">$history Table</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#snapshots-table" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:``$snapshots`` table (reference label)">$snapshots Table</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manifests-table" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:``$manifests`` table (reference label)">$manifests Table</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#partitions-table" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:``$partitions`` table (reference label)">$partitions Table</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#files-table" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:``$files`` table (reference label)">$files Table</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#changelog-table" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:``$changelog`` table (reference label)">$changelog Table</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#refs-table" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:``$refs`` table (reference label)">$refs Table</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#id6" class="md-nav__link">
    
    <span class="md-ellipsis">
      Presto C++ Support
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
        <li class="md-nav__item">
  <a href="#procedures" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:procedures (reference label)">Procedures</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Procedures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#register-table" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:register table (reference label)">Register Table</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unregister-table" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:unregister table (reference label)">Unregister Table</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rollback-to-snapshot" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:rollback to snapshot (reference label)">Rollback to Snapshot</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rollback-to-timestamp" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:rollback to timestamp (reference label)">Rollback to Timestamp</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-current-snapshot" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:set current snapshot (reference label)">Set Current Snapshot</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#expire-snapshots" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:expire snapshots (reference label)">Expire Snapshots</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remove-orphan-files" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:remove orphan files (reference label)">Remove Orphan Files</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fast-forward-branch" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:fast forward branch (reference label)">Fast Forward Branch</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#statistics-file-cache-invalidation-procedure" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:statistics file cache invalidation procedure (reference label)">Statistics file cache invalidation procedure</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manifest-file-cache-invalidation-procedure" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:manifest file cache invalidation procedure (reference label)">Manifest file cache invalidation procedure</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-table-property" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:set table property (reference label)">Set Table Property</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#id7" class="md-nav__link">
    
    <span class="md-ellipsis">
      Presto C++ Support
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
        <li class="md-nav__item">
  <a href="#sql-support" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:sql support (reference label)">SQL Support</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SQL Support">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-schema" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:create schema (reference label)">CREATE SCHEMA</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-table" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:create table (reference label)">CREATE TABLE</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CREATE TABLE">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#partition-column-transform" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:partition column transform (reference label)">Partition Column Transform</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#types-for-partition-transforms" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:types for partition transforms (reference label)">Types for partition transforms</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#id8" class="md-nav__link">
    
    <span class="md-ellipsis">
      Presto C++ Support
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-view" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:create view (reference label)">CREATE VIEW</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#insert-into" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:insert into (reference label)">INSERT INTO</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-table-as-select" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:create table as select (reference label)">CREATE TABLE AS SELECT</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#select" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:select (reference label)">SELECT</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SELECT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#table-with-delete-files" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:table with delete files (reference label)">Table with delete files</span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alter-table" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:alter table (reference label)">ALTER TABLE</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alter-view" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:alter view (reference label)">ALTER VIEW</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#truncate" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:truncate (reference label)">TRUNCATE</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:delete (reference label)">DELETE</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#id9" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:drop table (reference label)">DROP TABLE</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#drop-view" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:drop view (reference label)">DROP VIEW</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#drop-schema" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:drop schema (reference label)">DROP SCHEMA</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show-create-table" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:show create table (reference label)">SHOW CREATE TABLE</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show-columns" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:show columns (reference label)">SHOW COLUMNS</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#describe" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:describe (reference label)">DESCRIBE</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:update (reference label)">UPDATE</span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
        <li class="md-nav__item">
  <a href="#schema-evolution" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:schema evolution (reference label)">Schema Evolution</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Schema Evolution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#id10" class="md-nav__link">
    
    <span class="md-ellipsis">
      Presto C++ Support
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
        <li class="md-nav__item">
  <a href="#parquet-writer-version" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:parquet writer version (reference label)">Parquet Writer Version</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Parquet Writer Version">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#id11" class="md-nav__link">
    
    <span class="md-ellipsis">
      Presto C++ Support
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-queries" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:example queries (reference label)">Example Queries</span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
        <li class="md-nav__item">
  <a href="#time-travel" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:time travel (reference label)">Time Travel</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Time Travel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-time-travel-queries" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:example time travel queries (reference label)">Example Time Travel Queries</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#time-travel-using-version-system-version-and-timestamp-system-time" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:time travel using version (system_version) and timestamp (system_time) (reference label)">Time Travel using VERSION <wbr>(SYSTEM_<wbr>VERSION) and TIMESTAMP <wbr>(SYSTEM_<wbr>TIME)</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#querying-branches-and-tags" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:querying branches and tags (reference label)">Querying branches and tags</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#id12" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:presto c++ support (reference label)">Presto C++ Support</span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
        <li class="md-nav__item">
  <a href="#type-mapping" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:type mapping (reference label)">Type mapping</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Type mapping">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#iceberg-to-prestodb-type-mapping" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:iceberg to prestodb type mapping (reference label)">Iceberg to Presto<wbr>DB type mapping</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prestodb-to-iceberg-type-mapping" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:prestodb to iceberg type mapping (reference label)">Presto<wbr>DB to Iceberg type mapping</span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
        <li class="md-nav__item">
  <a href="#sorted-tables" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:sorted tables (reference label)">Sorted Tables</span>
    </span>
  </a>
  
</li>
        
    </ul>
    
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="jmx.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    JMX Connector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="kafka.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kafka Connector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="kafka-tutorial.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kafka Connector Tutorial
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="kudu.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kudu Connector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="larksheets.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lark Sheets Connector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="localfile.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Local File Connector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="memory.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Memory Connector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="mongodb.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mongo<wbr>DB Connector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="mysql.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    My<wbr>SQL Connector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="oracle.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Oracle Connector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="pinot.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Apache Pinot Connector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="postgresql.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Postgre<wbr>SQL Connector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="prometheus.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Prometheus Connector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="redis.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Redis Connector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="redshift.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Redshift Connector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="scylladb.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Scylla<wbr>DB Connector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="singlestore.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Single<wbr>Store Connector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="sqlserver.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SQL Server Connector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="system.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    System Connector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="thrift.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Thrift Connector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="tpcds.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TPCDS Connector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="tpch.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TPCH Connector
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../plugin.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Plugins
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../functions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Functions and Operators
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../language.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SQL Language
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../sql.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SQL Statement Syntax
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../migration.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Migration
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../rest.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    REST API
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../ecosystem.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ecosystem
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../router.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Router
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../develop.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Developer Guide
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../presto-cpp.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Presto C++
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../troubleshoot.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Troubleshooting
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../release.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Release Notes
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary">
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
        <li class="md-nav__item">
            <a href="https://github.com/prestodb/presto/blob/master/presto-docs/src/main/sphinx/connector/iceberg.rst" class="">
                <span class="md-source__icon md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0 8a5 5 0 0 1-5-5 5 5 0 0 1 5-5 5 5 0 0 1 5 5 5 5 0 0 1-5 5m0-12.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5"/></svg>
                </span>
                View Page Source
            </a>
        </li>
        <li class="md-nav__item">
            <a href="https://github.com/prestodb/presto/edit/master/presto-docs/src/main/sphinx/connector/iceberg.rst" class="">
                <span class="md-source__icon md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6 2c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-1.9l10-10V8l-6-6zm7 1.5L18.5 9H13zm7.1 9.5c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-2 1.8L12 20.9V23h2.1l6.1-6.1z"/></svg>
                </span>
                Edit this page
            </a>
        </li>
        <li class="md-nav__item">
            <a href="https://github.com/prestodb/presto/issues/new?title=Documentation&labels=docs"
                class="">
                <span class="md-source__icon md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M40 48c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24h48c13.3 0 24-10.7 24-24V72c0-13.3-10.7-24-24-24zm152 16c-17.7 0-32 14.3-32 32s14.3 32 32 32h288c17.7 0 32-14.3 32-32s-14.3-32-32-32zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32h288c17.7 0 32-14.3 32-32s-14.3-32-32-32zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32h288c17.7 0 32-14.3 32-32s-14.3-32-32-32zM16 232v48c0 13.3 10.7 24 24 24h48c13.3 0 24-10.7 24-24v-48c0-13.3-10.7-24-24-24H40c-13.3 0-24 10.7-24 24m24 136c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24h48c13.3 0 24-10.7 24-24v-48c0-13.3-10.7-24-24-24z"/></svg>
                </span>
                Create docs issue
            </a>
        </li>
        <li class="md-nav__item">
            <a href="https://github.com/prestodb/presto/issues/new" class="">
                <span class="md-source__icon  md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M40 48c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24h48c13.3 0 24-10.7 24-24V72c0-13.3-10.7-24-24-24zm152 16c-17.7 0-32 14.3-32 32s14.3 32 32 32h288c17.7 0 32-14.3 32-32s-14.3-32-32-32zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32h288c17.7 0 32-14.3 32-32s-14.3-32-32-32zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32h288c17.7 0 32-14.3 32-32s-14.3-32-32-32zM16 232v48c0 13.3 10.7 24 24 24h48c13.3 0 24-10.7 24-24v-48c0-13.3-10.7-24-24-24H40c-13.3 0-24 10.7-24 24m24 136c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24h48c13.3 0 24-10.7 24-24v-48c0-13.3-10.7-24-24-24z"/></svg>
                </span>
                Create project issue
            </a>
        </li>
        <li class="md-nav__item">
            <a href="https://communityinviter.com/apps/prestodb/prestodb" class="">
                <span class="md-source__icon  md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M94.12 315.1c0 25.9-21.16 47.06-47.06 47.06S0 341 0 315.1s21.16-47.06 47.06-47.06h47.06zm23.72 0c0-25.9 21.16-47.06 47.06-47.06s47.06 21.16 47.06 47.06v117.84c0 25.9-21.16 47.06-47.06 47.06s-47.06-21.16-47.06-47.06zm47.06-188.98c-25.9 0-47.06-21.16-47.06-47.06S139 32 164.9 32s47.06 21.16 47.06 47.06v47.06zm0 23.72c25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06H47.06C21.16 243.96 0 222.8 0 196.9s21.16-47.06 47.06-47.06zm188.98 47.06c0-25.9 21.16-47.06 47.06-47.06S448 171 448 196.9s-21.16 47.06-47.06 47.06h-47.06zm-23.72 0c0 25.9-21.16 47.06-47.06 47.06s-47.06-21.16-47.06-47.06V79.06c0-25.9 21.16-47.06 47.06-47.06s47.06 21.16 47.06 47.06zM283.1 385.88c25.9 0 47.06 21.16 47.06 47.06S309 480 283.1 480s-47.06-21.16-47.06-47.06v-47.06zm0-23.72c-25.9 0-47.06-21.16-47.06-47.06s21.16-47.06 47.06-47.06h117.84c25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06z"/></svg>
                </span>
                Join PrestoDB on Slack
            </a>
        </li>
    </ul>
    <hr>
    
    
    
    <label class="md-nav__title" for="__toc">
        <span class="md-nav__icon md-icon"></span>
        Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
        
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:overview (reference label)">Overview</span>
    </span>
  </a>
  
</li>
        
        <li class="md-nav__item">
  <a href="#metastores" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:metastores (reference label)">Metastores</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Metastores">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hive-metastore-catalog" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:hive metastore catalog (reference label)">Hive Metastore catalog</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#file-based-metastore" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:file-based metastore (reference label)">File-<wbr>Based Metastore</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#glue-catalog" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:glue catalog (reference label)">Glue catalog</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nessie-catalog" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:nessie catalog (reference label)">Nessie catalog</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Nessie catalog">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#setting-up-nessie-with-docker" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:setting up nessie with docker (reference label)">Setting Up Nessie With Docker</span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rest-catalog" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:rest catalog (reference label)">REST catalog</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hadoop-catalog" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:hadoop catalog (reference label)">Hadoop catalog</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#presto-c-support" class="md-nav__link">
    
    <span class="md-ellipsis">
      Presto C++ Support
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
        <li class="md-nav__item">
  <a href="#configuration-properties" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:configuration properties (reference label)">Configuration Properties</span>
    </span>
  </a>
  
</li>
        
        <li class="md-nav__item">
  <a href="#table-properties" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:table properties (reference label)">Table Properties</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Table Properties">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deprecated-table-properties" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:deprecated table properties (reference label)">Deprecated Table Properties</span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
        <li class="md-nav__item">
  <a href="#session-properties" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:session properties (reference label)">Session Properties</span>
    </span>
  </a>
  
</li>
        
        <li class="md-nav__item">
  <a href="#caching-support" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:caching support (reference label)">Caching Support</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Caching Support">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#statistics-file-caching" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:statistics file caching (reference label)">Statistics File Caching</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manifest-file-caching" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:manifest file caching (reference label)">Manifest File Caching</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Manifest File Caching">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#id2" class="md-nav__link">
    
    <span class="md-ellipsis">
      Presto C++ Support
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alluxio-data-cache" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:alluxio data cache (reference label)">Alluxio Data Cache</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Alluxio Data Cache">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#id3" class="md-nav__link">
    
    <span class="md-ellipsis">
      Presto C++ Support
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#file-and-stripe-footer-cache" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:file and stripe footer cache (reference label)">File And Stripe Footer Cache</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File And Stripe Footer Cache">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#id4" class="md-nav__link">
    
    <span class="md-ellipsis">
      Presto C++ Support
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metastore-cache" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:metastore cache (reference label)">Metastore Cache</span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
        <li class="md-nav__item">
  <a href="#extra-hidden-metadata-columns" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:extra hidden metadata columns (reference label)">Extra Hidden Metadata Columns</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Extra Hidden Metadata Columns">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#path-column" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:``$path`` column (reference label)">$path column</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-sequence-number-column" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:``$data_sequence_number`` column (reference label)">$data_<wbr>sequence_<wbr>number column</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deleted-column" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:``$deleted`` column (reference label)">$deleted column</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete-file-path-column" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:``$delete_file_path`` column (reference label)">$delete_<wbr>file_<wbr>path column</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#id5" class="md-nav__link">
    
    <span class="md-ellipsis">
      Presto C++ Support
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
        <li class="md-nav__item">
  <a href="#extra-hidden-metadata-tables" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:extra hidden metadata tables (reference label)">Extra Hidden Metadata Tables</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Extra Hidden Metadata Tables">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#properties-table" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:``$properties`` table (reference label)">$properties Table</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#history-table" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:``$history`` table (reference label)">$history Table</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#snapshots-table" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:``$snapshots`` table (reference label)">$snapshots Table</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manifests-table" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:``$manifests`` table (reference label)">$manifests Table</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#partitions-table" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:``$partitions`` table (reference label)">$partitions Table</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#files-table" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:``$files`` table (reference label)">$files Table</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#changelog-table" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:``$changelog`` table (reference label)">$changelog Table</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#refs-table" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:``$refs`` table (reference label)">$refs Table</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#id6" class="md-nav__link">
    
    <span class="md-ellipsis">
      Presto C++ Support
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
        <li class="md-nav__item">
  <a href="#procedures" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:procedures (reference label)">Procedures</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Procedures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#register-table" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:register table (reference label)">Register Table</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unregister-table" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:unregister table (reference label)">Unregister Table</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rollback-to-snapshot" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:rollback to snapshot (reference label)">Rollback to Snapshot</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rollback-to-timestamp" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:rollback to timestamp (reference label)">Rollback to Timestamp</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-current-snapshot" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:set current snapshot (reference label)">Set Current Snapshot</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#expire-snapshots" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:expire snapshots (reference label)">Expire Snapshots</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remove-orphan-files" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:remove orphan files (reference label)">Remove Orphan Files</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fast-forward-branch" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:fast forward branch (reference label)">Fast Forward Branch</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#statistics-file-cache-invalidation-procedure" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:statistics file cache invalidation procedure (reference label)">Statistics file cache invalidation procedure</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manifest-file-cache-invalidation-procedure" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:manifest file cache invalidation procedure (reference label)">Manifest file cache invalidation procedure</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-table-property" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:set table property (reference label)">Set Table Property</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#id7" class="md-nav__link">
    
    <span class="md-ellipsis">
      Presto C++ Support
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
        <li class="md-nav__item">
  <a href="#sql-support" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:sql support (reference label)">SQL Support</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SQL Support">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-schema" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:create schema (reference label)">CREATE SCHEMA</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-table" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:create table (reference label)">CREATE TABLE</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CREATE TABLE">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#partition-column-transform" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:partition column transform (reference label)">Partition Column Transform</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#types-for-partition-transforms" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:types for partition transforms (reference label)">Types for partition transforms</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#id8" class="md-nav__link">
    
    <span class="md-ellipsis">
      Presto C++ Support
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-view" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:create view (reference label)">CREATE VIEW</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#insert-into" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:insert into (reference label)">INSERT INTO</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-table-as-select" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:create table as select (reference label)">CREATE TABLE AS SELECT</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#select" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:select (reference label)">SELECT</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SELECT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#table-with-delete-files" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:table with delete files (reference label)">Table with delete files</span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alter-table" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:alter table (reference label)">ALTER TABLE</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alter-view" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:alter view (reference label)">ALTER VIEW</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#truncate" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:truncate (reference label)">TRUNCATE</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:delete (reference label)">DELETE</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#id9" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:drop table (reference label)">DROP TABLE</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#drop-view" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:drop view (reference label)">DROP VIEW</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#drop-schema" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:drop schema (reference label)">DROP SCHEMA</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show-create-table" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:show create table (reference label)">SHOW CREATE TABLE</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show-columns" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:show columns (reference label)">SHOW COLUMNS</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#describe" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:describe (reference label)">DESCRIBE</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:update (reference label)">UPDATE</span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
        <li class="md-nav__item">
  <a href="#schema-evolution" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:schema evolution (reference label)">Schema Evolution</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Schema Evolution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#id10" class="md-nav__link">
    
    <span class="md-ellipsis">
      Presto C++ Support
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
        <li class="md-nav__item">
  <a href="#parquet-writer-version" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:parquet writer version (reference label)">Parquet Writer Version</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Parquet Writer Version">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#id11" class="md-nav__link">
    
    <span class="md-ellipsis">
      Presto C++ Support
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-queries" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:example queries (reference label)">Example Queries</span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
        <li class="md-nav__item">
  <a href="#time-travel" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:time travel (reference label)">Time Travel</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Time Travel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-time-travel-queries" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:example time travel queries (reference label)">Example Time Travel Queries</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#time-travel-using-version-system-version-and-timestamp-system-time" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:time travel using version (system_version) and timestamp (system_time) (reference label)">Time Travel using VERSION <wbr>(SYSTEM_<wbr>VERSION) and TIMESTAMP <wbr>(SYSTEM_<wbr>TIME)</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#querying-branches-and-tags" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:querying branches and tags (reference label)">Querying branches and tags</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#id12" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:presto c++ support (reference label)">Presto C++ Support</span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
        <li class="md-nav__item">
  <a href="#type-mapping" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:type mapping (reference label)">Type mapping</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Type mapping">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#iceberg-to-prestodb-type-mapping" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:iceberg to prestodb type mapping (reference label)">Iceberg to Presto<wbr>DB type mapping</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prestodb-to-iceberg-type-mapping" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:prestodb to iceberg type mapping (reference label)">Presto<wbr>DB to Iceberg type mapping</span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
        <li class="md-nav__item">
  <a href="#sorted-tables" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="connector/iceberg:sorted tables (reference label)">Sorted Tables</span>
    </span>
  </a>
  
</li>
        
    </ul>
    
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset" role="main">
                  



  
  

<h1 id="iceberg-connector">Iceberg Connector<a class="headerlink" href="#iceberg-connector" title="Link to this heading">¶</a></h1>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Link to this heading">¶</a></h2>
<p>The Iceberg connector allows querying data stored in Iceberg tables.</p>
<h2 id="metastores">Metastores<a class="headerlink" href="#metastores" title="Link to this heading">¶</a></h2>
<p>Iceberg tables store most of the metadata in the metadata files, along with the data on the
filesystem, but it still requires a central place to find the current location of the
current metadata pointer for a table. This central place is called the <code class="docutils literal notranslate"><span class="pre">Iceberg</span> <span class="pre">Catalog</span></code>.
The Presto Iceberg connector supports different types of Iceberg Catalogs : <code class="docutils literal notranslate"><span class="pre">HIVE</span></code>,
<code class="docutils literal notranslate"><span class="pre">NESSIE</span></code>, <code class="docutils literal notranslate"><span class="pre">REST</span></code>, and <code class="docutils literal notranslate"><span class="pre">HADOOP</span></code>.</p>
<p>To configure the Iceberg connector, create a catalog properties file
<code class="docutils literal notranslate"><span class="pre">etc/catalog/iceberg.properties</span></code>. To define the catalog type, <code class="docutils literal notranslate"><span class="pre">iceberg.catalog.type</span></code> property
is required along with the following contents, with the property values replaced as follows:</p>
<h3 id="hive-metastore-catalog">Hive Metastore catalog<a class="headerlink" href="#hive-metastore-catalog" title="Link to this heading">¶</a></h3>
<p>The Iceberg connector supports the same configuration for
<a class="reference external" href="https://prestodb.io/docs/current/connector/hive.html#metastore-configuration-properties">HMS</a>
as a Hive connector.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span><code>connector.name=iceberg
hive.metastore.uri=hostname:port
iceberg.catalog.type=hive
</code></pre></div>
</div>
<h3 id="file-based-metastore">File-Based Metastore<a class="headerlink" href="#file-based-metastore" title="Link to this heading">¶</a></h3>
<p>For testing or development purposes, this connector can be configured to use a local
filesystem directory as a Hive Metastore. See <a class="reference internal" href="../installation/deployment.html#file-based-metastore"><span class="std std-ref">File-Based Metastore</span></a>.</p>
<h3 id="glue-catalog">Glue catalog<a class="headerlink" href="#glue-catalog" title="Link to this heading">¶</a></h3>
<p>The Iceberg connector supports the same configuration for
<a class="reference external" href="https://prestodb.io/docs/current/connector/hive.html#aws-glue-catalog-configuration-properties">Glue</a>
as a Hive connector.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span><code>connector.name=iceberg
hive.metastore=glue
iceberg.catalog.type=hive
</code></pre></div>
</div>
<p>There are additional configurations available when using the Iceberg connector configured with Hive
or Glue catalogs.</p>
<table class="docutils data align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Property Name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Default</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.metastore.uri</span></code></p></td>
<td><p>The URI(s) of the Hive metastore to connect to using the
Thrift protocol. If multiple URIs are provided, the first
URI is used by default, and the rest of the URIs are
fallback metastores.</p>
<p>Example: <code class="docutils literal notranslate"><span class="pre">thrift://192.0.2.3:9083</span></code> or
<code class="docutils literal notranslate"><span class="pre">thrift://192.0.2.3:9083,thrift://192.0.2.4:9083</span></code>.</p>
<p>This property is required if the
<code class="docutils literal notranslate"><span class="pre">iceberg.catalog.type</span></code> is <code class="docutils literal notranslate"><span class="pre">hive</span></code> and <code class="docutils literal notranslate"><span class="pre">hive.metastore</span></code>
is <code class="docutils literal notranslate"><span class="pre">thrift</span></code>.</p>
</td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.metastore.catalog.name</span></code></p></td>
<td><p>Specifies the catalog name to be passed to the metastore.</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.hive-statistics-merge-strategy</span></code></p></td>
<td><p>Comma separated list of statistics to use from the
Hive Metastore to override Iceberg table statistics.
The available values are <code class="docutils literal notranslate"><span class="pre">NUMBER_OF_DISTINCT_VALUES</span></code>
and <code class="docutils literal notranslate"><span class="pre">TOTAL_SIZE_IN_BYTES</span></code>.</p>
<p><strong>Note</strong>: Only valid when the Iceberg connector is
configured with Hive.</p>
</td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.hive.table-refresh.backoff-min-sleep-time</span></code></p></td>
<td><p>The minimum amount of time to sleep between retries when
refreshing table metadata.</p></td>
<td><p>100ms</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.hive.table-refresh.backoff-max-sleep-time</span></code></p></td>
<td><p>The maximum amount of time to sleep between retries when
refreshing table metadata.</p></td>
<td><p>5s</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.hive.table-refresh.max-retry-time</span></code></p></td>
<td><p>The maximum amount of time to take across all retries before
failing a table metadata refresh operation.</p></td>
<td><p>1min</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.hive.table-refresh.retries</span></code></p></td>
<td><p>The number of times to retry after errors when refreshing
table metadata using the Hive metastore.</p></td>
<td><p>20</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.hive.table-refresh.backoff-scale-factor</span></code></p></td>
<td><p>The multiple used to scale subsequent wait time between
retries.</p></td>
<td><p>4.0</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.engine.hive.lock-enabled</span></code></p></td>
<td><p>Whether to use locks to ensure atomicity of commits.
This will turn off locks but is overridden at a table level
with the table configuration <code class="docutils literal notranslate"><span class="pre">engine.hive.lock-enabled</span></code>.</p></td>
<td><p>true</p></td>
</tr>
</tbody>
</table>
<h3 id="nessie-catalog">Nessie catalog<a class="headerlink" href="#nessie-catalog" title="Link to this heading">¶</a></h3>
<p>To use a Nessie catalog, configure the catalog type as
<code class="docutils literal notranslate"><span class="pre">iceberg.catalog.type=nessie</span></code>.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span><code>connector.name=iceberg
iceberg.catalog.type=nessie
iceberg.catalog.warehouse=/tmp
iceberg.nessie.uri=https://localhost:19120/api/v1
</code></pre></div>
</div>
<p>Additional supported properties for the Nessie catalog:</p>
<table class="docutils data align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Property Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.nessie.ref</span></code></p></td>
<td><p>The branch/tag to use for Nessie, defaults to <code class="docutils literal notranslate"><span class="pre">main</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.nessie.uri</span></code></p></td>
<td><p>Nessie API endpoint URI (required).
Example: <code class="docutils literal notranslate"><span class="pre">https://localhost:19120/api/v1</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.nessie.auth.type</span></code></p></td>
<td><p>The authentication type to use.
Available values are <code class="docutils literal notranslate"><span class="pre">BASIC</span></code> or <code class="docutils literal notranslate"><span class="pre">BEARER</span></code>.
Example: <code class="docutils literal notranslate"><span class="pre">BEARER</span></code></p>
<p><strong>Note:</strong> Nessie BASIC authentication type is deprecated,
this will be removed in upcoming release</p>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.nessie.auth.basic.username</span></code></p></td>
<td><p>The username to use with <code class="docutils literal notranslate"><span class="pre">BASIC</span></code> authentication.
Example: <code class="docutils literal notranslate"><span class="pre">test_user</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.nessie.auth.basic.password</span></code></p></td>
<td><p>The password to use with <code class="docutils literal notranslate"><span class="pre">BASIC</span></code> authentication.
Example: <code class="docutils literal notranslate"><span class="pre">my$ecretPass</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.nessie.auth.bearer.token</span></code></p></td>
<td><p>The token to use with <code class="docutils literal notranslate"><span class="pre">BEARER</span></code> authentication.
Example: <code class="docutils literal notranslate"><span class="pre">SXVLUXUhIExFQ0tFUiEK</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.nessie.read-timeout-ms</span></code></p></td>
<td><p>The read timeout in milliseconds for requests
to the Nessie server.
Example: <code class="docutils literal notranslate"><span class="pre">5000</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.nessie.connect-timeout-ms</span></code></p></td>
<td><p>The connection timeout in milliseconds for the connection
requests to the Nessie server.
Example: <code class="docutils literal notranslate"><span class="pre">10000</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.nessie.compression-enabled</span></code></p></td>
<td><p>Configuration of whether compression should be enabled or
not for requests to the Nessie server, defaults to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.nessie.client-builder-impl</span></code></p></td>
<td><p>Configuration of the custom ClientBuilder implementation
class to be used.</p></td>
</tr>
</tbody>
</table>
<h4 id="setting-up-nessie-with-docker">Setting Up Nessie With Docker<a class="headerlink" href="#setting-up-nessie-with-docker" title="Link to this heading">¶</a></h4>
<p>To set up a Nessie instance locally using the Docker image, see <a class="reference external" href="https://projectnessie.org/try/docker/">Setting up Nessie</a>. Once the Docker instance is up and running, you should see logs similar to the following example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span><code>2023-09-05 13:11:37,905 INFO  [io.quarkus] (main) nessie-quarkus 0.69.0 on JVM (powered by Quarkus 3.2.4.Final) started in 1.921s. Listening on: http://0.0.0.0:19120
2023-09-05 13:11:37,906 INFO  [io.quarkus] (main) Profile prod activated.
2023-09-05 13:11:37,906 INFO  [io.quarkus] (main) Installed features: [agroal, amazon-dynamodb, cassandra-client, cdi, google-cloud-bigtable, hibernate-validator, jdbc-postgresql, logging-sentry, micrometer, mongodb-client, narayana-jta, oidc, opentelemetry, reactive-routes, resteasy, resteasy-jackson, security, security-properties-file, smallrye-context-propagation, smallrye-health, smallrye-openapi, swagger-ui, vertx]
</code></pre></div>
</div>
<p>If log messages related to Nessie’s OpenTelemetry collector appear similar to the following example, you can disable OpenTelemetry using the configuration option <code class="docutils literal notranslate"><span class="pre">quarkus.otel.sdk.disabled=true</span></code>.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span><code>2023-08-27 11:10:02,492 INFO  [io.qua.htt.access-log] (executor-thread-1) 172.17.0.1 - - [27/Aug/2023:11:10:02 +0000] &quot;GET /api/v1/config HTTP/1.1&quot; 200 62
2023-08-27 11:10:05,007 SEVERE [io.ope.exp.int.grp.OkHttpGrpcExporter] (OkHttp http://localhost:4317/...) Failed to export spans. The request could not be executed. Full error message: Failed to connect to localhost/127.0.0.1:4317
</code></pre></div>
</div>
<p>For example, start the Docker image using the following command:
<code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">run</span> <span class="pre">-p</span> <span class="pre">19120:19120</span> <span class="pre">-e</span> <span class="pre">QUARKUS_OTEL_SDK_DISABLED=true</span> <span class="pre">ghcr.io/projectnessie/nessie</span></code></p>
<p>For more information about this configuration option and other related options, see the <a class="reference external" href="https://quarkus.io/guides/opentelemetry#quarkus-opentelemetry_quarkus.otel.sdk.disabled">OpenTelemetry Configuration Reference</a>.</p>
<p>For more information about troubleshooting OpenTelemetry traces, see <a class="reference external" href="https://projectnessie.org/try/configuration/#troubleshooting-traces">Troubleshooting traces</a>.</p>
<p>If an error similar to the following example is displayed, this is probably because you are interacting with an http server, and not an https server. You need to set <code class="docutils literal notranslate"><span class="pre">iceberg.nessie.uri</span></code> to <code class="docutils literal notranslate"><span class="pre">http://localhost:19120/api/v1</span></code>.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span><code>Caused by: javax.net.ssl.SSLException: Unsupported or unrecognized SSL message
    at sun.security.ssl.SSLSocketInputRecord.handleUnknownRecord(SSLSocketInputRecord.java:448)
    at sun.security.ssl.SSLSocketInputRecord.decode(SSLSocketInputRecord.java:174)
    at sun.security.ssl.SSLTransport.decode(SSLTransport.java:111)
    at sun.security.ssl.SSLSocketImpl.decode(SSLSocketImpl.java:1320)
    at sun.security.ssl.SSLSocketImpl.readHandshakeRecord(SSLSocketImpl.java:1233)
    at sun.security.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:417)
    at sun.security.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:389)
    at sun.net.www.protocol.https.HttpsClient.afterConnect(HttpsClient.java:558)
    at sun.net.www.protocol.https.AbstractDelegateHttpsURLConnection.connect(AbstractDelegateHttpsURLConnection.java:201)
    at sun.net.www.protocol.https.HttpsURLConnectionImpl.connect(HttpsURLConnectionImpl.java:167)
    at org.projectnessie.client.http.impl.jdk8.UrlConnectionRequest.executeRequest(UrlConnectionRequest.java:71)
    ... 42 more
</code></pre></div>
</div>
<h3 id="rest-catalog">REST catalog<a class="headerlink" href="#rest-catalog" title="Link to this heading">¶</a></h3>
<p>To use a REST catalog, configure the catalog type as
<code class="docutils literal notranslate"><span class="pre">iceberg.catalog.type=rest</span></code>. A minimal configuration includes:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span><code>connector.name=iceberg
iceberg.catalog.type=rest
iceberg.rest.uri=https://localhost:8181
</code></pre></div>
</div>
<p>Additional supported properties for the REST catalog:</p>
<table class="docutils data align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Property Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.rest.uri</span></code></p></td>
<td><p>REST API endpoint URI (required).
Example: <code class="docutils literal notranslate"><span class="pre">https://localhost:8181</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.rest.auth.type</span></code></p></td>
<td><p>The authentication type to use.
Available values are <code class="docutils literal notranslate"><span class="pre">NONE</span></code> or <code class="docutils literal notranslate"><span class="pre">OAUTH2</span></code> (default: <code class="docutils literal notranslate"><span class="pre">NONE</span></code>).
<code class="docutils literal notranslate"><span class="pre">OAUTH2</span></code> requires either a credential or token.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.rest.auth.oauth2.uri</span></code></p></td>
<td><p>OAUTH2 server endpoint URI.
Example: <code class="docutils literal notranslate"><span class="pre">https://localhost:9191</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.rest.auth.oauth2.credential</span></code></p></td>
<td><p>The credential to use for OAUTH2 authentication.
Example: <code class="docutils literal notranslate"><span class="pre">key:secret</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.rest.auth.oauth2.token</span></code></p></td>
<td><p>The Bearer token to use for OAUTH2 authentication.
Example: <code class="docutils literal notranslate"><span class="pre">SXVLUXUhIExFQ0tFUiEK</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.rest.auth.oauth2.scope</span></code></p></td>
<td><p>The scope to use for OAUTH2 authentication.
This property is only applicable when using
<code class="docutils literal notranslate"><span class="pre">iceberg.rest.auth.oauth2.credential</span></code>.
Example: <code class="docutils literal notranslate"><span class="pre">PRINCIPAL_ROLE:ALL</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.rest.nested.namespace.enabled</span></code></p></td>
<td><p>In REST Catalogs, tables are grouped into namespaces, that can be
nested. But if a large number of recursive namespaces result in
lower performance, querying nested namespaces can be disabled.
Defaults to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.rest.session.type</span></code></p></td>
<td><p>The session type to use when communicating with the REST catalog.
Available values are <code class="docutils literal notranslate"><span class="pre">NONE</span></code> or <code class="docutils literal notranslate"><span class="pre">USER</span></code> (default: <code class="docutils literal notranslate"><span class="pre">NONE</span></code>).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.catalog.warehouse</span></code></p></td>
<td><p>A catalog warehouse root path for Iceberg tables (optional).
Example: <code class="docutils literal notranslate"><span class="pre">s3://warehouse/</span></code></p></td>
</tr>
</tbody>
</table>
<h3 id="hadoop-catalog">Hadoop catalog<a class="headerlink" href="#hadoop-catalog" title="Link to this heading">¶</a></h3>
<p>To use a Hadoop catalog, configure the catalog type as
<code class="docutils literal notranslate"><span class="pre">iceberg.catalog.type=hadoop</span></code>. A minimal configuration includes:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span><code>connector.name=iceberg
iceberg.catalog.type=hadoop
iceberg.catalog.warehouse=hdfs://hostname:port
</code></pre></div>
</div>
<p>Hadoop catalog configuration properties:</p>
<table class="docutils data align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Property Name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Default</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.catalog.warehouse</span></code></p></td>
<td><p>The catalog warehouse root path for Iceberg tables.</p>
<p>The Hadoop catalog requires a file system that supports
an atomic rename operation, such as HDFS, to maintain
metadata files in order to implement an atomic transaction
commit.</p>
<p>Example: <code class="docutils literal notranslate"><span class="pre">hdfs://nn:8020/warehouse/path</span></code></p>
<p>Do not set <code class="docutils literal notranslate"><span class="pre">iceberg.catalog.warehouse</span></code> to a path in object
stores or local file systems in the production environment.</p>
<p>This property is required if the <code class="docutils literal notranslate"><span class="pre">iceberg.catalog.type</span></code> is
<code class="docutils literal notranslate"><span class="pre">hadoop</span></code>. Otherwise, it will be ignored.</p>
</td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.catalog.hadoop.warehouse.datadir</span></code></p></td>
<td><p>The catalog warehouse root data path for Iceberg tables.
It is only supported with the Hadoop catalog.</p>
<p>Example: <code class="docutils literal notranslate"><span class="pre">s3://iceberg_bucket/warehouse</span></code>.</p>
<p>This optional property can be set to a path in object
stores or HDFS.
If set, all tables in this Hadoop catalog default to saving
their data and delete files in the specified root
data directory.</p>
</td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.catalog.cached-catalog-num</span></code></p></td>
<td><p>The number of Iceberg catalogs to cache. This property is
required if the <code class="docutils literal notranslate"><span class="pre">iceberg.catalog.type</span></code> is <code class="docutils literal notranslate"><span class="pre">hadoop</span></code>.
Otherwise, it will be ignored.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">10</span></code></p></td>
</tr>
</tbody>
</table>
<p>Configure the <a class="reference external" href="https://prestodb.io/docs/current/connector/hive.html#amazon-s3-configuration">Amazon S3</a>
properties to specify a S3 location as the warehouse data directory for the Hadoop catalog. This way,
the data and delete files of Iceberg tables are stored in S3. An example configuration includes:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span><code>connector.name=iceberg
iceberg.catalog.type=hadoop
iceberg.catalog.warehouse=hdfs://nn:8020/warehouse/path
iceberg.catalog.hadoop.warehouse.datadir=s3://iceberg_bucket/warehouse

hive.s3.use-instance-credentials=false
hive.s3.aws-access-key=accesskey
hive.s3.aws-secret-key=secretkey
hive.s3.endpoint=http://192.168.0.103:9878
hive.s3.path-style-access=true
</code></pre></div>
</div>
<h3 id="presto-c-support">Presto C++ Support<a class="headerlink" href="#presto-c-support" title="Link to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">HIVE</span></code>, <code class="docutils literal notranslate"><span class="pre">NESSIE</span></code>, <code class="docutils literal notranslate"><span class="pre">REST</span></code>, and <code class="docutils literal notranslate"><span class="pre">HADOOP</span></code> Iceberg catalogs are supported in Presto C++.</p>
<h2 id="configuration-properties">Configuration Properties<a class="headerlink" href="#configuration-properties" title="Link to this heading">¶</a></h2>
<div class="note admonition">
<p class="admonition-title">Note</p>
<p>The Iceberg connector supports configuration options for
<a class="reference external" href="https://prestodb.io/docs/current/connector/hive.html#amazon-s3-configuration">Amazon S3</a>
as a Hive connector.</p>
</div>
<p>The following configuration properties are available for all catalog types:</p>
<table class="docutils data align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Property Name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Presto Java Support</p></th>
<th class="head"><p>Presto C++ Support</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.catalog.type</span></code></p></td>
<td><p>The catalog type for Iceberg tables. The available values
are <code class="docutils literal notranslate"><span class="pre">HIVE</span></code>, <code class="docutils literal notranslate"><span class="pre">HADOOP</span></code>, and <code class="docutils literal notranslate"><span class="pre">NESSIE</span></code> and <code class="docutils literal notranslate"><span class="pre">REST</span></code>.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">HIVE</span></code></p></td>
<td><p>Yes</p></td>
<td><p>Yes, only needed on coordinator</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.hadoop.config.resources</span></code></p></td>
<td><p>The path(s) for Hadoop configuration resources.</p>
<p>Example: <code class="docutils literal notranslate"><span class="pre">/etc/hadoop/conf/core-site.xml.</span></code> This property
is required if the iceberg.catalog.type is <code class="docutils literal notranslate"><span class="pre">hadoop</span></code>.
Otherwise, it will be ignored.</p>
</td>
<td></td>
<td><p>Yes</p></td>
<td><p>Yes, only needed on coordinator</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.file-format</span></code></p></td>
<td><p>The storage file format for Iceberg tables. The available
values are <code class="docutils literal notranslate"><span class="pre">PARQUET</span></code> and <code class="docutils literal notranslate"><span class="pre">ORC</span></code>.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">PARQUET</span></code></p></td>
<td><p>Yes</p></td>
<td><p>No, write is not supported yet</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.compression-codec</span></code></p></td>
<td><p>The compression codec to use when writing files. The
available values are <code class="docutils literal notranslate"><span class="pre">NONE</span></code>, <code class="docutils literal notranslate"><span class="pre">SNAPPY</span></code>, <code class="docutils literal notranslate"><span class="pre">GZIP</span></code>,
<code class="docutils literal notranslate"><span class="pre">LZ4</span></code>, and <code class="docutils literal notranslate"><span class="pre">ZSTD</span></code>.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">GZIP</span></code></p></td>
<td><p>Yes</p></td>
<td><p>No, write is not supported yet</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.max-partitions-per-writer</span></code></p></td>
<td><p>The maximum number of partitions handled per writer.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">100</span></code></p></td>
<td><p>Yes</p></td>
<td><p>No, write is not supported yet</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.minimum-assigned-split-weight</span></code></p></td>
<td><p>A decimal value in the range (0, 1] is used as a minimum
for weights assigned to each split. A low value may improve
performance on tables with small files. A higher value may
improve performance for queries with highly skewed
aggregations or joins.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0.05</span></code></p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.enable-merge-on-read-mode</span></code></p></td>
<td><p>Enable reading base tables that use merge-on-read for
updates.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">true</span></code></p></td>
<td><p>Yes</p></td>
<td><p>Yes, only needed on coordinator</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.delete-as-join-rewrite-enabled</span></code></p></td>
<td><p>When enabled, equality delete row filtering is applied
as a join with the data of the equality delete files.
Deprecated: This property is deprecated and will be removed
in a future release. Use the
<code class="docutils literal notranslate"><span class="pre">iceberg.delete-as-join-rewrite-max-delete-columns</span></code>
configuration property instead.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">true</span></code></p></td>
<td><p>Yes</p></td>
<td><p>No, Equality delete read is not supported</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.delete-as-join-rewrite-max-delete-columns</span></code></p></td>
<td><p>When set to a number greater than 0, this property enables
equality delete row filtering as a join with the data of the
equality delete files. The value of this property is the
maximum number of columns that can be used in the equality
delete files. If the number of columns in the equality delete
files exceeds this value, then the optimization is not
applied and the equality delete files are applied directly to
each row in the data files.</p>
<p>This property is only applicable when
<code class="docutils literal notranslate"><span class="pre">iceberg.delete-as-join-rewrite-enabled</span></code> is set to
<code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
</td>
<td><p><code class="docutils literal notranslate"><span class="pre">400</span></code></p></td>
<td><p>Yes</p></td>
<td><p>No, Equality delete read is not supported</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.enable-parquet-dereference-pushdown</span></code></p></td>
<td><p>Enable parquet dereference pushdown.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">true</span></code></p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.statistic-snapshot-record-difference-weight</span></code></p></td>
<td><p>The amount that the difference in total record count matters
when calculating the closest snapshot when picking
statistics. A value of 1 means a single record is equivalent
to 1 millisecond of time difference.</p></td>
<td></td>
<td><p>Yes</p></td>
<td><p>Yes, only needed on coordinator</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.pushdown-filter-enabled</span></code></p></td>
<td><p>Experimental: Enable filter pushdown for Iceberg. This is
only supported with Presto C++.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">false</span></code></p></td>
<td><p>No</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.rows-for-metadata-optimization-threshold</span></code></p></td>
<td><p>The maximum number of partitions in an Iceberg table to
allow optimizing queries of that table using metadata. If
an Iceberg table has more partitions than this threshold,
metadata optimization is skipped.</p>
<p>Set to <code class="docutils literal notranslate"><span class="pre">0</span></code> to disable metadata optimization.</p>
</td>
<td><p><code class="docutils literal notranslate"><span class="pre">1000</span></code></p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.split-manager-threads</span></code></p></td>
<td><p>Number of threads to use for generating Iceberg splits.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Number</span> <span class="pre">of</span> <span class="pre">available</span> <span class="pre">processors</span></code></p></td>
<td><p>Yes</p></td>
<td><p>Yes, only needed on coordinator</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.metadata-previous-versions-max</span></code></p></td>
<td><p>The maximum number of old metadata files to keep in
current metadata log.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">100</span></code></p></td>
<td><p>Yes</p></td>
<td><p>No, write is not supported yet</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.metadata-delete-after-commit</span></code></p></td>
<td><p>Set to <code class="docutils literal notranslate"><span class="pre">true</span></code> to delete the oldest metadata files after
each commit.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">false</span></code></p></td>
<td><p>Yes</p></td>
<td><p>No, write is not supported yet</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.metrics-max-inferred-column</span></code></p></td>
<td><p>The maximum number of columns for which metrics
are collected.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">100</span></code></p></td>
<td><p>Yes</p></td>
<td><p>No, write is not supported yet</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.max-statistics-file-cache-size</span></code></p></td>
<td><p>Maximum size in bytes that should be consumed by the
statistics file cache.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">256MB</span></code></p></td>
<td><p>Yes</p></td>
<td><p>Yes, only needed on coordinator</p></td>
</tr>
</tbody>
</table>
<h2 id="table-properties">Table Properties<a class="headerlink" href="#table-properties" title="Link to this heading">¶</a></h2>
<p>Table properties set metadata for the underlying tables. This is key for
CREATE TABLE/CREATE TABLE AS statements. Table properties are passed to the
connector using a WITH clause:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">tablename</span>
<span class="k">WITH</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">property_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">property_value</span><span class="p">,</span>
<span class="w">    </span><span class="p">...</span>
<span class="p">)</span>
</code></pre></div>
</div>
<p>The following table properties are available, which are specific to the Presto Iceberg connector:</p>
<table class="docutils data align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Property Name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Presto Java Support</p></th>
<th class="head"><p>Presto C++ Support</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">commit.retry.num-retries</span></code></p></td>
<td><p>Determines the number of attempts for committing the metadata
in case of concurrent upsert requests, before failing.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">4</span></code></p></td>
<td><p>Yes</p></td>
<td><p>No, write is not supported yet</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">format-version</span></code></p></td>
<td><p>Optionally specifies the format version of the Iceberg
specification to use for new tables, either <code class="docutils literal notranslate"><span class="pre">1</span></code> or <code class="docutils literal notranslate"><span class="pre">2</span></code>.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">2</span></code></p></td>
<td><p>Yes</p></td>
<td><p>No, write is not supported yet</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">location</span></code></p></td>
<td><p>Optionally specifies the file system location URI for
the table.</p></td>
<td></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">partitioning</span></code></p></td>
<td><p>Optionally specifies table partitioning. If a table
is partitioned by columns <code class="docutils literal notranslate"><span class="pre">c1</span></code> and <code class="docutils literal notranslate"><span class="pre">c2</span></code>, the partitioning
property is <code class="docutils literal notranslate"><span class="pre">partitioning</span> <span class="pre">=</span> <span class="pre">ARRAY['c1',</span> <span class="pre">'c2']</span></code>.</p></td>
<td></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">read.split.target-size</span></code></p></td>
<td><p>The target size for an individual split when generating splits
for a table scan. Generated splits may still be larger or
smaller than this value. Must be specified in bytes.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">134217728</span></code> (128MB)</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">write.data.path</span></code></p></td>
<td><p>Optionally specifies the file system location URI for
storing the data and delete files of the table. This only
applies to files written after this property is set. Files
previously written aren’t relocated to reflect this
parameter.</p></td>
<td></td>
<td><p>Yes</p></td>
<td><p>No, write is not supported yet</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">write.delete.mode</span></code></p></td>
<td><p>Optionally specifies the write delete mode of the Iceberg
specification to use for new tables, either <code class="docutils literal notranslate"><span class="pre">copy-on-write</span></code>
or <code class="docutils literal notranslate"><span class="pre">merge-on-read</span></code>.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">merge-on-read</span></code></p></td>
<td><p>Yes</p></td>
<td><p>No, write is not supported yet</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">write.format.default</span></code></p></td>
<td><p>Optionally specifies the format of table data files,
either <code class="docutils literal notranslate"><span class="pre">PARQUET</span></code> or <code class="docutils literal notranslate"><span class="pre">ORC</span></code>.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">PARQUET</span></code></p></td>
<td><p>Yes</p></td>
<td><p>No, write is not supported yet</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">write.metadata.previous-versions-max</span></code></p></td>
<td><p>Optionally specifies the max number of old metadata files to
keep in current metadata log.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">100</span></code></p></td>
<td><p>Yes</p></td>
<td><p>No, write is not supported yet</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">write.metadata.delete-after-commit.enabled</span></code></p></td>
<td><p>Set to <code class="docutils literal notranslate"><span class="pre">true</span></code> to delete the oldest metadata file after
each commit.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">false</span></code></p></td>
<td><p>Yes</p></td>
<td><p>No, write is not supported yet</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">write.metadata.metrics.max-inferred-column-defaults</span></code></p></td>
<td><p>Optionally specifies the maximum number of columns for which
metrics are collected.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">100</span></code></p></td>
<td><p>Yes</p></td>
<td><p>No, write is not supported yet</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">write.update.mode</span></code></p></td>
<td><p>Optionally specifies the write delete mode of the Iceberg
specification to use for new tables, either <code class="docutils literal notranslate"><span class="pre">copy-on-write</span></code>
or <code class="docutils literal notranslate"><span class="pre">merge-on-read</span></code>.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">merge-on-read</span></code></p></td>
<td><p>Yes</p></td>
<td><p>No, write is not supported yet</p></td>
</tr>
</tbody>
</table>
<p>The table definition below specifies format <code class="docutils literal notranslate"><span class="pre">ORC</span></code>, partitioning by columns <code class="docutils literal notranslate"><span class="pre">c1</span></code> and <code class="docutils literal notranslate"><span class="pre">c2</span></code>,
and a file system location of <code class="docutils literal notranslate"><span class="pre">s3://test_bucket/test_schema/test_table</span></code>:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">test_table</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">c1</span><span class="w"> </span><span class="nb">bigint</span><span class="p">,</span>
<span class="w">    </span><span class="n">c2</span><span class="w"> </span><span class="nb">varchar</span><span class="p">,</span>
<span class="w">    </span><span class="n">c3</span><span class="w"> </span><span class="n">double</span>
<span class="p">)</span>
<span class="k">WITH</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">format</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;ORC&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="n">partitioning</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ARRAY</span><span class="p">[</span><span class="s1">&#39;c1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;c2&#39;</span><span class="p">],</span>
<span class="w">    </span><span class="k">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;s3://test_bucket/test_schema/test_table&#39;</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div>
</div>
<h3 id="deprecated-table-properties">Deprecated Table Properties<a class="headerlink" href="#deprecated-table-properties" title="Link to this heading">¶</a></h3>
<p>Some table properties have been deprecated or removed. The following table lists the deprecated
properties and their replacements. Update queries to use the new property names as soon as
possible. They will be removed in a future version.</p>
<table class="docutils data align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Deprecated Property Name</p></th>
<th class="head"><p>New Property Name</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">format</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">write.format.default</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">format_version</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">format-version</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">commit_retries</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">commit.retry.num-retries</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">delete_mode</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">write.delete.mode</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">metadata_previous_versions_max</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">write.metadata.previous-versions-max</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">metadata_delete_after_commit</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">write.metadata.delete-after-commit.enabled</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">metrics_max_inferred_column</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">write.metadata.metrics.max-inferred-column-defaults</span></code></p></td>
</tr>
</tbody>
</table>
<h2 id="session-properties">Session Properties<a class="headerlink" href="#session-properties" title="Link to this heading">¶</a></h2>
<p>Session properties set behavior changes for queries executed within the given session.</p>
<table class="docutils data align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Property Name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Presto Java Support</p></th>
<th class="head"><p>Presto C++ Support</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.delete_as_join_rewrite_enabled</span></code></p></td>
<td><p>Overrides the behavior of the connector property
<code class="docutils literal notranslate"><span class="pre">iceberg.delete-as-join-rewrite-enabled</span></code> in the current session.</p>
<p>Deprecated: This property is deprecated and will be removed.  Use
<code class="docutils literal notranslate"><span class="pre">iceberg.delete_as_join_rewrite_max_delete_columns</span></code> instead.</p>
</td>
<td><p>Yes</p></td>
<td><p>No, Equality delete read is not supported</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.delete_as_join_rewrite_max_delete_columns</span></code></p></td>
<td><p>Overrides the behavior of the connector property
<code class="docutils literal notranslate"><span class="pre">iceberg.delete-as-join-rewrite-max-delete-columns</span></code> in the
current session.</p></td>
<td><p>Yes</p></td>
<td><p>No, Equality delete read is not supported</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.hive_statistics_merge_strategy</span></code></p></td>
<td><p>Overrides the behavior of the connector property
<code class="docutils literal notranslate"><span class="pre">iceberg.hive-statistics-merge-strategy</span></code> in the current session.</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.rows_for_metadata_optimization_threshold</span></code></p></td>
<td><p>Overrides the behavior of the connector property
<code class="docutils literal notranslate"><span class="pre">iceberg.rows-for-metadata-optimization-threshold</span></code> in the current
session.</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.target_split_size_bytes</span></code></p></td>
<td><p>Overrides the target split size for all tables in a query in bytes.
Set to 0 to use the value in each Iceberg table’s
<code class="docutils literal notranslate"><span class="pre">read.split.target-size</span></code> property.</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.affinity_scheduling_file_section_size</span></code></p></td>
<td><p>When the <code class="docutils literal notranslate"><span class="pre">node_selection_strategy</span></code> or
<code class="docutils literal notranslate"><span class="pre">hive.node-selection-strategy</span></code> property is set to <code class="docutils literal notranslate"><span class="pre">SOFT_AFFINITY</span></code>,
this configuration property will change the size of a file chunk that
is hashed to a particular node when determining the which worker to
assign a split to. Splits which read data from the same file within
the same chunk will hash to the same node. A smaller chunk size will
result in a higher probability splits being distributed evenly across
the cluster, but reduce locality.
See <a class="reference internal" href="../develop/connectors.html#node-selection-strategy"><span class="std std-ref">Node Selection Strategy</span></a>.</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.parquet_dereference_pushdown_enabled</span></code></p></td>
<td><p>Overrides the behavior of the connector property
<code class="docutils literal notranslate"><span class="pre">iceberg.enable-parquet-dereference-pushdown</span></code> in the current session.</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
</tr>
</tbody>
</table>
<h2 id="caching-support">Caching Support<a class="headerlink" href="#caching-support" title="Link to this heading">¶</a></h2>
<h3 id="statistics-file-caching">Statistics File Caching<a class="headerlink" href="#statistics-file-caching" title="Link to this heading">¶</a></h3>
<p>Support for Puffin-based statistics caching. It is enabled by default.</p>
<p>JMX query to get the metrics and verify the cache usage:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">jmx</span><span class="p">.</span><span class="k">current</span><span class="p">.</span><span class="ss">&quot;com.facebook.presto.iceberg.statistics:name=iceberg,type=statisticsfilecache&quot;</span><span class="p">;</span>
</code></pre></div>
</div>
<h3 id="manifest-file-caching">Manifest File Caching<a class="headerlink" href="#manifest-file-caching" title="Link to this heading">¶</a></h3>
<p>As of Iceberg version 1.1.0, Apache Iceberg provides a mechanism to cache the contents of Iceberg manifest files in memory. This feature helps
to reduce repeated reads of small Iceberg manifest files from remote storage.</p>
<p>The following configuration properties are available:</p>
<table class="docutils data align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Property Name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Default</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.io.manifest.cache-enabled</span></code></p></td>
<td><p>Enable or disable the manifest caching feature.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">true</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.io-impl</span></code></p></td>
<td><p>Custom FileIO implementation to use in a catalog. It must
be set to enable manifest caching. This is only needed for
Hadoop, Nessie and REST catalogs.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">org.apache.iceberg.hadoop.HadoopFileIO</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.io.manifest.cache.max-total-bytes</span></code></p></td>
<td><p>Maximum size of cache size in bytes.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">104857600</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.io.manifest.cache.expiration-interval-ms</span></code></p></td>
<td><p>Maximum time duration in milliseconds for which an entry
stays in the manifest cache. Set to 0 to disable entry
expiration.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">60000</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">iceberg.io.manifest.cache.max-content-length</span></code></p></td>
<td><p>Maximum length of a manifest file to be considered for
caching in bytes. Manifest files with a length exceeding
this size will not be cached.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">8388608</span></code></p></td>
</tr>
</tbody>
</table>
<p>JMX query to get the metrics and verify the cache usage:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">jmx</span><span class="p">.</span><span class="k">current</span><span class="p">.</span><span class="ss">&quot;com.facebook.presto.iceberg:name=iceberg,type=manifestfilecache&quot;</span><span class="p">;</span>
</code></pre></div>
</div>
<div class="note admonition">
<p class="admonition-title">Note</p>
<p>Manifest file cache statistics are only available through the JMX connector when the Iceberg connector is configured with a HIVE catalog type.</p>
</div>
<h4 id="id2">Presto C++ Support<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h4>
<p>Manifest file caching is supported in Presto C++.</p>
<h3 id="alluxio-data-cache">Alluxio Data Cache<a class="headerlink" href="#alluxio-data-cache" title="Link to this heading">¶</a></h3>
<p>A Presto worker caches remote storage data in its original form (compressed and possibly encrypted) on local SSD upon read.</p>
<p>The following configuration properties are required to set in the Iceberg catalog file (catalog/iceberg.properties):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span><code>cache.enabled=true
cache.base-directory=file:///mnt/flash/data
cache.type=ALLUXIO
cache.alluxio.max-cache-size=1600GB
hive.node-selection-strategy=SOFT_AFFINITY
</code></pre></div>
</div>
<p>JMX queries to get the metrics and verify the cache usage:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">jmx</span><span class="p">.</span><span class="k">current</span><span class="p">.</span><span class="ss">&quot;com.facebook.alluxio:name=client.cachehitrate,type=gauges&quot;</span><span class="p">;</span>

<span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">jmx</span><span class="p">.</span><span class="k">current</span><span class="p">.</span><span class="ss">&quot;com.facebook.alluxio:name=client.cachebytesreadcache,type=meters&quot;</span><span class="p">;</span>

<span class="k">SHOW</span><span class="w"> </span><span class="n">TABLES</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">jmx</span><span class="p">.</span><span class="k">current</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%alluxio%&#39;</span><span class="p">;</span>
</code></pre></div>
</div>
<h4 id="id3">Presto C++ Support<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h4>
<p>Alluxio data caching is applicable for Presto Java. Async data cache is supported in Presto C++. See <a class="reference internal" href="../presto_cpp/features.html#async-data-caching-and-prefetching"><span class="std std-ref">Async Data Cache and Prefetching</span></a>.</p>
<h3 id="file-and-stripe-footer-cache">File And Stripe Footer Cache<a class="headerlink" href="#file-and-stripe-footer-cache" title="Link to this heading">¶</a></h3>
<p>Caches open file descriptors and stripe or file footer information in leaf worker memory. These pieces of data are mostly frequently accessed when reading files.</p>
<p>The following configuration properties are required to set in the Iceberg catalog file (catalog/iceberg.properties):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span><code># scheduling
hive.node-selection-strategy=SOFT_AFFINITY

# orc
iceberg.orc.file-tail-cache-enabled=true
iceberg.orc.file-tail-cache-size=100MB
iceberg.orc.file-tail-cache-ttl-since-last-access=6h
iceberg.orc.stripe-metadata-cache-enabled=true
iceberg.orc.stripe-footer-cache-size=100MB
iceberg.orc.stripe-footer-cache-ttl-since-last-access=6h
iceberg.orc.stripe-stream-cache-size=300MB
iceberg.orc.stripe-stream-cache-ttl-since-last-access=6h

# parquet
iceberg.parquet.metadata-cache-enabled=true
iceberg.parquet.metadata-cache-size=100MB
iceberg.parquet.metadata-cache-ttl-since-last-access=6h
</code></pre></div>
</div>
<p>JMX queries to get the metrics and verify the cache usage:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">jmx</span><span class="p">.</span><span class="k">current</span><span class="p">.</span><span class="ss">&quot;com.facebook.presto.hive:name=iceberg_parquetmetadata,type=cachestatsmbean&quot;</span><span class="p">;</span>
</code></pre></div>
</div>
<h4 id="id4">Presto C++ Support<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h4>
<p>File and stripe footer cache is not applicable for Presto C++.</p>
<h3 id="metastore-cache">Metastore Cache<a class="headerlink" href="#metastore-cache" title="Link to this heading">¶</a></h3>
<p>Iceberg Connector does not support Metastore Caching.</p>
<h2 id="extra-hidden-metadata-columns">Extra Hidden Metadata Columns<a class="headerlink" href="#extra-hidden-metadata-columns" title="Link to this heading">¶</a></h2>
<p>The Iceberg connector exposes extra hidden metadata columns. You can query these
as part of a SQL query by including them in your SELECT statement.</p>
<h3 id="path-column"><code class="docutils literal notranslate"><span class="pre">$path</span></code> column<a class="headerlink" href="#path-column" title="Link to this heading">¶</a></h3>
<p>The full file system path name of the file for this row.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="ss">&quot;$path&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">regionkey</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="ss">&quot;ctas_nation&quot;</span><span class="p">;</span>
</code></pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>        $path                    |  regionkey
---------------------------------+-----------
 /full/path/to/file/file.parquet | 2
</code></pre></div>
</div>
<h3 id="data-sequence-number-column"><code class="docutils literal notranslate"><span class="pre">$data_sequence_number</span></code> column<a class="headerlink" href="#data-sequence-number-column" title="Link to this heading">¶</a></h3>
<p>The Iceberg data sequence number in which this row was added.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="ss">&quot;$data_sequence_number&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">regionkey</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="ss">&quot;ctas_nation&quot;</span><span class="p">;</span>
</code></pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>        $data_sequence_number     |  regionkey
----------------------------------+------------
             2                    | 3
</code></pre></div>
</div>
<h3 id="deleted-column"><code class="docutils literal notranslate"><span class="pre">$deleted</span></code> column<a class="headerlink" href="#deleted-column" title="Link to this heading">¶</a></h3>
<p>Whether this row is a deleted row. When this column is used, deleted rows
from delete files will be marked as <code class="docutils literal notranslate"><span class="pre">true</span></code> instead of being filtered out of the results.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="ss">&quot;ctas_nation&quot;</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">regionkey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="k">SELECT</span><span class="w"> </span><span class="ss">&quot;$deleted&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">regionkey</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="ss">&quot;ctas_nation&quot;</span><span class="p">;</span>
</code></pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code> $deleted | regionkey
----------+-----------
 true     |         0
 false    |         1
</code></pre></div>
</div>
<h3 id="delete-file-path-column"><code class="docutils literal notranslate"><span class="pre">$delete_file_path</span></code> column<a class="headerlink" href="#delete-file-path-column" title="Link to this heading">¶</a></h3>
<p>The path of the delete file corresponding to a deleted row, or NULL if the row was not deleted.
When this column is used, deleted rows will not be filtered out of the results.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="ss">&quot;ctas_nation&quot;</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">regionkey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="k">SELECT</span><span class="w"> </span><span class="ss">&quot;$delete_file_path&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">regionkey</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="ss">&quot;ctas_nation&quot;</span><span class="p">;</span>
</code></pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>                                 $delete_file_path                                 | regionkey
-----------------------------------------------------------------------------------+-----------
 file:/path/to/table/data/delete_file_d8510b3e-510a-4fc2-b2b2-e59ead7fd386.parquet |         0
 NULL                                                                              |         1
</code></pre></div>
</div>
<h3 id="id5">Presto C++ Support<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h3>
<p>All above metadata columns are supported in Presto C++.</p>
<h2 id="extra-hidden-metadata-tables">Extra Hidden Metadata Tables<a class="headerlink" href="#extra-hidden-metadata-tables" title="Link to this heading">¶</a></h2>
<p>The Iceberg connector exposes extra hidden metadata tables. You can query these
as a part of a SQL query by appending name to the table.</p>
<h3 id="properties-table"><code class="docutils literal notranslate"><span class="pre">$properties</span></code> Table<a class="headerlink" href="#properties-table" title="Link to this heading">¶</a></h3>
<p>General properties of the given table.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="ss">&quot;ctas_nation$properties&quot;</span><span class="p">;</span>
</code></pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>        key           |  value
----------------------+---------
 write.format.default | PARQUET
</code></pre></div>
</div>
<h3 id="history-table"><code class="docutils literal notranslate"><span class="pre">$history</span></code> Table<a class="headerlink" href="#history-table" title="Link to this heading">¶</a></h3>
<p>History of table state changes.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="ss">&quot;ctas_nation$history&quot;</span><span class="p">;</span>
</code></pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>           made_current_at            |     snapshot_id     | parent_id | is_current_ancestor
--------------------------------------+---------------------+-----------+---------------------
2022-11-25 20:56:31.784 Asia/Kolkata  | 7606232158543069775 | NULL      | true
</code></pre></div>
</div>
<h3 id="snapshots-table"><code class="docutils literal notranslate"><span class="pre">$snapshots</span></code> Table<a class="headerlink" href="#snapshots-table" title="Link to this heading">¶</a></h3>
<p>Details about the table snapshots. For more information see <a class="reference external" href="https://iceberg.apache.org/spec/#snapshots">Snapshots</a> in the Iceberg Table Spec.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="ss">&quot;ctas_nation$snapshots&quot;</span><span class="p">;</span>
</code></pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>             committed_at             |     snapshot_id     | parent_id | operation |                                                  manifest_list                                           |                                                                                 summary
--------------------------------------+---------------------+-----------+-----------+----------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
2022-11-25 20:56:31.784 Asia/Kolkata  | 7606232158543069775 | NULL      | append    | s3://my-bucket/ctas_nation/metadata/snap-7606232158543069775-1-395a2cad-b244-409b-b030-cc44949e5a4e.avro | {changed-partition-count=1, added-data-files=1, total-equality-deletes=0, added-records=25, total-position-deletes=0, added-files-size=1648, total-delete-files=0, total-files-size=1648, total-records=25, total-data-files=1}
</code></pre></div>
</div>
<h3 id="manifests-table"><code class="docutils literal notranslate"><span class="pre">$manifests</span></code> Table<a class="headerlink" href="#manifests-table" title="Link to this heading">¶</a></h3>
<p>Details about the manifests of different table snapshots. For more information see <a class="reference external" href="https://iceberg.apache.org/spec/#manifests">Manifests</a> in the Iceberg Table Spec.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="ss">&quot;ctas_nation$manifests&quot;</span><span class="p">;</span>
</code></pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>                                           path                                  | length | partition_spec_id |  added_snapshot_id  | added_data_files_count | existing_data_files_count | deleted_data_files_count | partitions
---------------------------------------------------------------------------------+--------+-------------------+---------------------+------------------------+---------------------------+--------------------------+-----------
s3://my-bucket/ctas_nation/metadata/395a2cad-b244-409b-b030-cc44949e5a4e-m0.avro |   5957 |                 0 | 7606232158543069775 |                      1 |                         0 |                    0     |    []
</code></pre></div>
</div>
<h3 id="partitions-table"><code class="docutils literal notranslate"><span class="pre">$partitions</span></code> Table<a class="headerlink" href="#partitions-table" title="Link to this heading">¶</a></h3>
<p>Detailed partition information for the table.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="ss">&quot;ctas_nation$partitions&quot;</span><span class="p">;</span>
</code></pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code> row_count | file_count | total_size |           nationkey           |                   name                   |          regionkey           |                          comment
-----------+------------+------------+-------------------------------+------------------------------------------+------------------------------+------------------------------------------------------------
    25     |          1 |       1648 | {min=0, max=24, null_count=0} | {min=ALGERIA, max=VIETNAM, null_count=0} | {min=0, max=4, null_count=0} | {min= haggle. careful, max=y final packaget, null_count=0}
</code></pre></div>
</div>
<h3 id="files-table"><code class="docutils literal notranslate"><span class="pre">$files</span></code> Table<a class="headerlink" href="#files-table" title="Link to this heading">¶</a></h3>
<p>Overview of data files in the current snapshot of the table.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="ss">&quot;ctas_nation$files&quot;</span><span class="p">;</span>
</code></pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code> content |                                      file_path                               | file_format | record_count | file_size_in_bytes |        column_sizes         |       value_counts       |  null_value_counts   | nan_value_counts |          lower_bounds                     |             upper_bounds                   | key_metadata | split_offsets | equality_ids
---------+------------------------------------------------------------------------------+-------------+--------------+--------------------+-----------------------------+--------------------------+----------------------+------------------+-------------------------------------------+--------------------------------------------+--------------+---------------+-------------
   0     | s3://my-bucket/ctas_nation/data/9f889274-6f74-4d28-8164-275eef99f660.parquet | PARQUET     |           25 |               1648 | {1=52, 2=222, 3=105, 4=757} | {1=25, 2=25, 3=25, 4=25} | {1=0, 2=0, 3=0, 4=0} |  NULL            | {1=0, 2=ALGERIA, 3=0, 4= haggle. careful} | {1=24, 2=VIETNAM, 3=4, 4=y final packaget} | NULL         | NULL          | NULL
</code></pre></div>
</div>
<h3 id="changelog-table"><code class="docutils literal notranslate"><span class="pre">$changelog</span></code> Table<a class="headerlink" href="#changelog-table" title="Link to this heading">¶</a></h3>
<p>This table lets you view which row-level changes have occurred to the table in a
particular order over time. The <code class="docutils literal notranslate"><span class="pre">$changelog</span></code> table presents the history of
changes to the table and makes the data available to process through a
query.</p>
<p>The result of a changelog query always returns a static schema with four
columns:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">operation</span></code>: (<code class="docutils literal notranslate"><span class="pre">VARCHAR</span></code>) indicating whether the row was inserted,
updated, or deleted.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ordinal</span></code>: (<code class="docutils literal notranslate"><span class="pre">int</span></code>) A number indicating a relative order that a particular
change needs to be applied to the table relative to all other changes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">snapshotid</span></code>: (<code class="docutils literal notranslate"><span class="pre">bigint</span></code>) Represents the snapshot a row-level
change was made in.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rowdata</span></code>: (<code class="docutils literal notranslate"><span class="pre">row(T)</span></code>) which includes the data for the particular row. The
inner values of this type match the schema of the parent table.</p></li>
</ol>
<p>The changelog table can be queried with the following name format:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="p">...</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="ss">&quot;&lt;table&gt;[@&lt;begin snapshot ID&gt;]$changelog[@&lt;end snapshot ID&gt;]&quot;</span>
</code></pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;table&gt;</span></code> is the name of the table.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;begin</span> <span class="pre">snapshot</span> <span class="pre">ID&gt;</span></code> is the snapshot of the table you want to begin viewing
changes from. This parameter is optional. If absent, the oldest available
snapshot is used.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;end</span> <span class="pre">snapshot</span> <span class="pre">ID&gt;</span></code> is the last snapshot for which you want to view changes.
This parameter is optional. If absent, the most current snapshot of the
table is used.</p></li>
</ul>
<p>One use for the <code class="docutils literal notranslate"><span class="pre">$changelog</span></code> table would be to find when a record was inserted
or removed from the table. To accomplish this, the  <code class="docutils literal notranslate"><span class="pre">$changelog</span></code> table can be
used in conjunction with the <code class="docutils literal notranslate"><span class="pre">$snapshots</span></code> table. First, choose a snapshot ID
from the <code class="docutils literal notranslate"><span class="pre">$snapshots</span></code> table to choose the starting point.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="ss">&quot;orders$snapshots&quot;</span><span class="p">;</span>
</code></pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>                committed_at                 |     snapshot_id     |      parent_id      | operation |                                                                                       manifest_list                                                                                        |                                                                                                              summary
---------------------------------------------+---------------------+---------------------+-----------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 2023-09-26 08:45:20.930 America/Los_Angeles | 2423571386296047175 | NULL                | append    | file:/var/folders/g_/6_hxl7r16qdddw7956j_r88h0000gn/T/PrestoTest8140889264166671718/catalog/tpch/ctas_orders/metadata/snap-2423571386296047175-1-3f288b1c-95a9-406b-9e17-9cfe31a11b48.avro | {changed-partition-count=1, added-data-files=4, total-equality-deletes=0, added-records=100, total-position-deletes=0, added-files-size=9580, total-delete-files=0, total-files-size=9580, total-records=100, total-data-files=4}
 2023-09-26 08:45:36.942 America/Los_Angeles | 8702997868627997320 | 2423571386296047175 | append    | file:/var/folders/g_/6_hxl7r16qdddw7956j_r88h0000gn/T/PrestoTest8140889264166671718/catalog/tpch/ctas_orders/metadata/snap-8702997868627997320-1-a2e1c714-7eed-4e2c-b144-dae4147ebaa4.avro | {changed-partition-count=1, added-data-files=1, total-equality-deletes=0, added-records=1, total-position-deletes=0, added-files-size=1687, total-delete-files=0, total-files-size=11267, total-records=101, total-data-files=5}
 2023-09-26 08:45:39.866 America/Los_Angeles | 7615903782581283889 | 8702997868627997320 | append    | file:/var/folders/g_/6_hxl7r16qdddw7956j_r88h0000gn/T/PrestoTest8140889264166671718/catalog/tpch/ctas_orders/metadata/snap-7615903782581283889-1-d94c2114-fd22-4de2-9ab5-c0b5bf67282f.avro | {changed-partition-count=1, added-data-files=3, total-equality-deletes=0, added-records=3, total-position-deletes=0, added-files-size=4845, total-delete-files=0, total-files-size=16112, total-records=104, total-data-files=8}
 2023-09-26 08:45:48.404 America/Los_Angeles |  677209275408372885 | 7615903782581283889 | append    | file:/var/folders/g_/6_hxl7r16qdddw7956j_r88h0000gn/T/PrestoTest8140889264166671718/catalog/tpch/ctas_orders/metadata/snap-677209275408372885-1-ad69e208-1440-459b-93e8-48e61f961758.avro  | {changed-partition-count=1, added-data-files=3, total-equality-deletes=0, added-records=5, total-position-deletes=0, added-files-size=4669, total-delete-files=0, total-files-size=20781, total-records=109, total-data-files=11}
</code></pre></div>
</div>
<p>Now that we know the snapshots available to query in the changelog, we can see
what changes were made to the table since it was created. Specifically, this
example uses the earliest snapshot ID: <code class="docutils literal notranslate"><span class="pre">2423571386296047175</span></code></p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="ss">&quot;ctas_orders@2423571386296047175$changelog&quot;</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">ordinal</span><span class="p">;</span>
</code></pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code> operation | ordinal |     snapshotid      |                                                                                                                   rowdata
-----------+---------+---------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 INSERT    |       0 | 8702997868627997320 | {orderkey=37504, custkey=1291, orderstatus=O, totalprice=165509.83, orderdate=1996-03-04, orderpriority=5-LOW, clerk=Clerk#000000871, shippriority=0, comment=c theodolites alongside of the fluffily bold requests haggle quickly against }
 INSERT    |       1 | 7615903782581283889 | {orderkey=12001, custkey=739, orderstatus=F, totalprice=138635.75, orderdate=1994-07-07, orderpriority=2-HIGH, clerk=Clerk#000000863, shippriority=0, comment=old, even theodolites. regular, special theodolites use furio}
 INSERT    |       1 | 7615903782581283889 | {orderkey=17989, custkey=364, orderstatus=F, totalprice=133669.05, orderdate=1994-01-17, orderpriority=4-NOT SPECIFIED, clerk=Clerk#000000547, shippriority=0, comment=ously express excuses. even theodolit}
 INSERT    |       1 | 7615903782581283889 | {orderkey=37504, custkey=1291, orderstatus=O, totalprice=165509.83, orderdate=1996-03-04, orderpriority=5-LOW, clerk=Clerk#000000871, shippriority=0, comment=c theodolites alongside of the fluffily bold requests haggle quickly against }
 INSERT    |       2 |  677209275408372885 | {orderkey=17991, custkey=92, orderstatus=O, totalprice=20732.51, orderdate=1998-07-09, orderpriority=4-NOT SPECIFIED, clerk=Clerk#000000636, shippriority=0, comment= the quickly express accounts. iron}
 INSERT    |       2 |  677209275408372885 | {orderkey=17989, custkey=364, orderstatus=F, totalprice=133669.05, orderdate=1994-01-17, orderpriority=4-NOT SPECIFIED, clerk=Clerk#000000547, shippriority=0, comment=ously express excuses. even theodolit}
 INSERT    |       2 |  677209275408372885 | {orderkey=17990, custkey=458, orderstatus=O, totalprice=218031.58, orderdate=1998-03-18, orderpriority=3-MEDIUM, clerk=Clerk#000000340, shippriority=0, comment=ounts wake final foxe}
 INSERT    |       2 |  677209275408372885 | {orderkey=18016, custkey=403, orderstatus=O, totalprice=174070.99, orderdate=1996-03-19, orderpriority=1-URGENT, clerk=Clerk#000000629, shippriority=0, comment=ly. quickly ironic excuses are furiously. carefully ironic pack}
 INSERT    |       2 |  677209275408372885 | {orderkey=18017, custkey=958, orderstatus=F, totalprice=203091.02, orderdate=1993-03-26, orderpriority=1-URGENT, clerk=Clerk#000000830, shippriority=0, comment=sleep quickly bold requests. slyly pending pinto beans haggle in pla}
</code></pre></div>
</div>
<h3 id="refs-table"><code class="docutils literal notranslate"><span class="pre">$refs</span></code> Table<a class="headerlink" href="#refs-table" title="Link to this heading">¶</a></h3>
<p>Details about Iceberg references including branches and tags. For more information see <a class="reference external" href="https://iceberg.apache.org/docs/nightly/branching/">Branching and Tagging</a>.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="ss">&quot;ctas_nation$refs&quot;</span><span class="p">;</span>
</code></pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>   name     |  type  |     snapshot_id     | max_reference_age_in_ms | min_snapshots_to_keep | max_snapshot_age_in_ms
------------+--------+---------------------+-------------------------+-----------------------+------------------------
 main       | BRANCH | 3074797416068623476 | NULL                    | NULL                  | NULL
 testBranch | BRANCH | 3374797416068698476 | NULL                    | NULL                  | NULL
 testTag    | TAG    | 4686954189838128572 | 10                      | NULL                  | NULL
</code></pre></div>
</div>
<h3 id="id6">Presto C++ Support<a class="headerlink" href="#id6" title="Link to this heading">¶</a></h3>
<p>All above metadata tables, except <cite>$changelog</cite>, are supported in Presto C++.</p>
<h2 id="procedures">Procedures<a class="headerlink" href="#procedures" title="Link to this heading">¶</a></h2>
<p>Use the <a class="reference internal" href="../sql/call.html"><span class="doc">CALL</span></a> statement to perform data manipulation or administrative tasks. Procedures are available in the <code class="docutils literal notranslate"><span class="pre">system</span></code> schema of the catalog.</p>
<h3 id="register-table">Register Table<a class="headerlink" href="#register-table" title="Link to this heading">¶</a></h3>
<p>Iceberg tables for which table data and metadata already exist in the
file system can be registered with the catalog. Use the <code class="docutils literal notranslate"><span class="pre">register_table</span></code>
procedure on the catalog’s <code class="docutils literal notranslate"><span class="pre">system</span></code> schema to register a table which
already exists but does not known by the catalog.</p>
<p>The following arguments are available:</p>
<table class="docutils data align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Argument Name</p></th>
<th class="head"><p>Required</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">schema</span></code></p></td>
<td><p>Yes</p></td>
<td><p>string</p></td>
<td><p>Schema of the table to register</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">table_name</span></code></p></td>
<td><p>Yes</p></td>
<td><p>string</p></td>
<td><p>Name of the table to register</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">metadata_location</span></code></p></td>
<td><p>Yes</p></td>
<td><p>string</p></td>
<td><p>The location of the table metadata which is to be registered</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">metadata_file</span></code></p></td>
<td></td>
<td><p>string</p></td>
<td><p>An optionally specified metadata file which is to be registered</p></td>
</tr>
</tbody>
</table>
<p>Examples:</p>
<ul>
<li><p>Register a table through supplying the target schema, desired table name, and the location of the table metadata:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">CALL</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">register_table</span><span class="p">(</span><span class="s1">&#39;schema_name&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;table_name&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;hdfs://localhost:9000/path/to/iceberg/table/metadata/dir&#39;</span><span class="p">)</span>

<span class="k">CALL</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">register_table</span><span class="p">(</span><span class="k">table_name</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;table_name&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">schema</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;schema_name&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">metadata_location</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;hdfs://localhost:9000/path/to/iceberg/table/metadata/dir&#39;</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="note admonition">
<p class="admonition-title">Note</p>
<p>If multiple metadata files of the same version exist at the specified location,
the most recently modified one is used.</p>
</div>
</li>
<li><p>Register a table through additionally supplying a specific metadata file:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">CALL</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">register_table</span><span class="p">(</span><span class="s1">&#39;schema_name&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;table_name&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;hdfs://localhost:9000/path/to/iceberg/table/metadata/dir&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;00000-35a08aed-f4b0-4010-95d2-9d73ef4be01c.metadata.json&#39;</span><span class="p">)</span>

<span class="k">CALL</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">register_table</span><span class="p">(</span><span class="k">table_name</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;table_name&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">schema</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;schema_name&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">metadata_location</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;hdfs://localhost:9000/path/to/iceberg/table/metadata/dir&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">metadata_file</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;00000-35a08aed-f4b0-4010-95d2-9d73ef4be01c.metadata.json&#39;</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="note admonition">
<p class="admonition-title">Note</p>
<p>The Iceberg REST catalog may not support table register depending on the
type of the backing catalog.</p>
</div>
<div class="note admonition">
<p class="admonition-title">Note</p>
<p>When registering a table with the Hive metastore, the user calling the procedure
is set as the owner of the table and has <code class="docutils literal notranslate"><span class="pre">SELECT</span></code>, <code class="docutils literal notranslate"><span class="pre">INSERT</span></code>, <code class="docutils literal notranslate"><span class="pre">UPDATE</span></code>, and
<code class="docutils literal notranslate"><span class="pre">DELETE</span></code> privileges for that table. These privileges can be altered using the
<code class="docutils literal notranslate"><span class="pre">GRANT</span></code> and <code class="docutils literal notranslate"><span class="pre">REVOKE</span></code> commands.</p>
</div>
<div class="note admonition">
<p class="admonition-title">Note</p>
<p>When using the Hive catalog, attempts to read registered Iceberg tables
using the Hive connector will fail.</p>
</div>
</li>
</ul>
<h3 id="unregister-table">Unregister Table<a class="headerlink" href="#unregister-table" title="Link to this heading">¶</a></h3>
<p>Iceberg tables can be unregistered from the catalog using the <code class="docutils literal notranslate"><span class="pre">unregister_table</span></code>
procedure on the catalog’s <code class="docutils literal notranslate"><span class="pre">system</span></code> schema.</p>
<p>The following arguments are available:</p>
<table class="docutils data align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Argument Name</p></th>
<th class="head"><p>Required</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">schema</span></code></p></td>
<td><p>Yes</p></td>
<td><p>string</p></td>
<td><p>Schema of the table to unregister</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">table_name</span></code></p></td>
<td><p>Yes</p></td>
<td><p>string</p></td>
<td><p>Name of the table to unregister</p></td>
</tr>
</tbody>
</table>
<p>Examples:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">CALL</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">unregister_table</span><span class="p">(</span><span class="s1">&#39;schema_name&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;table_name&#39;</span><span class="p">)</span>

<span class="k">CALL</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">unregister_table</span><span class="p">(</span><span class="k">table_name</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;table_name&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">schema</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;schema_name&#39;</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="note admonition">
<p class="admonition-title">Note</p>
<p>Table data and metadata remain in the filesystem after a call to
<code class="docutils literal notranslate"><span class="pre">unregister_table</span></code> only when using the Hive catalog. This is similar to
the behavior listed for the <a class="reference external" href="#id1">DROP TABLE</a> command.</p>
</div>
<h3 id="rollback-to-snapshot">Rollback to Snapshot<a class="headerlink" href="#rollback-to-snapshot" title="Link to this heading">¶</a></h3>
<p>Rollback a table to a specific snapshot ID. Iceberg can rollback to a specific snapshot ID by using the <code class="docutils literal notranslate"><span class="pre">rollback_to_snapshot</span></code> procedure on Iceberg’s <code class="docutils literal notranslate"><span class="pre">system</span></code> schema:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">CALL</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">rollback_to_snapshot</span><span class="p">(</span><span class="s1">&#39;schema_name&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;table_name&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">snapshot_id</span><span class="p">);</span>
</code></pre></div>
</div>
<p>The following arguments are available:</p>
<table class="docutils data align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Argument Name</p></th>
<th class="head"><p>Required</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">schema</span></code></p></td>
<td><p>Yes</p></td>
<td><p>string</p></td>
<td><p>Schema of the table to update</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">table_name</span></code></p></td>
<td><p>Yes</p></td>
<td><p>string</p></td>
<td><p>Name of the table to update</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">snapshot_id</span></code></p></td>
<td><p>Yes</p></td>
<td><p>long</p></td>
<td><p>Snapshot ID to rollback to</p></td>
</tr>
</tbody>
</table>
<h3 id="rollback-to-timestamp">Rollback to Timestamp<a class="headerlink" href="#rollback-to-timestamp" title="Link to this heading">¶</a></h3>
<p>Rollback a table to a given point in time. Iceberg can rollback to a specific point in time by using the <code class="docutils literal notranslate"><span class="pre">rollback_to_timestamp</span></code> procedure on Iceberg’s <code class="docutils literal notranslate"><span class="pre">system</span></code> schema.</p>
<p>The following arguments are available:</p>
<table class="docutils data align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Argument Name</p></th>
<th class="head"><p>Required</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">schema</span></code></p></td>
<td><p>Yes</p></td>
<td><p>string</p></td>
<td><p>Schema of the table to update</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">table_name</span></code></p></td>
<td><p>Yes</p></td>
<td><p>string</p></td>
<td><p>Name of the table to update</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">timestamp</span></code></p></td>
<td><p>Yes</p></td>
<td><p>timestamp</p></td>
<td><p>Timestamp to rollback to</p></td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">CALL</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">rollback_to_timestamp</span><span class="p">(</span><span class="s1">&#39;schema_name&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;table_name&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="s1">&#39;1995-04-26 00:00:00.000&#39;</span><span class="p">);</span>
</code></pre></div>
</div>
<h3 id="set-current-snapshot">Set Current Snapshot<a class="headerlink" href="#set-current-snapshot" title="Link to this heading">¶</a></h3>
<p>Set a <code class="docutils literal notranslate"><span class="pre">snapshot_id</span></code> or <code class="docutils literal notranslate"><span class="pre">ref</span></code> as the current snapshot for a table.</p>
<div class="note admonition">
<p class="admonition-title">Note</p>
<p>Use either <code class="docutils literal notranslate"><span class="pre">snapshot_id</span></code> or <code class="docutils literal notranslate"><span class="pre">ref</span></code>, but do not use both in the same procedure.</p>
</div>
<p>The following arguments are available:</p>
<table class="docutils data align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Argument Name</p></th>
<th class="head"><p>Required</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">schema</span></code></p></td>
<td><p>Yes</p></td>
<td><p>string</p></td>
<td><p>Schema of the table to update</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">table_name</span></code></p></td>
<td><p>Yes</p></td>
<td><p>string</p></td>
<td><p>Name of the table to update</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">snapshot_id</span></code></p></td>
<td></td>
<td><p>long</p></td>
<td><p>Snapshot ID to set as current</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ref</span></code></p></td>
<td></td>
<td><p>string</p></td>
<td><p>Snapshot Reference (branch or tag) to set as current</p></td>
</tr>
</tbody>
</table>
<p>Examples:</p>
<ul>
<li><p>Set current table snapshot ID for the given table to 10000</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">CALL</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">set_current_snapshot</span><span class="p">(</span><span class="s1">&#39;schema_name&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;table_name&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">10000</span><span class="p">);</span>
</code></pre></div>
</div>
</li>
<li><p>Set current table snapshot ID for the given table to snapshot ID of branch1</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">CALL</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">set_current_snapshot</span><span class="p">(</span><span class="k">schema</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;schema_name&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">table_name</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;table_name&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">ref</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;branch1&#39;</span><span class="p">);</span>
</code></pre></div>
</div>
</li>
</ul>
<h3 id="expire-snapshots">Expire Snapshots<a class="headerlink" href="#expire-snapshots" title="Link to this heading">¶</a></h3>
<p>Each DML (Data Manipulation Language) action in Iceberg produces a new snapshot while keeping the old data and metadata for snapshot isolation and time travel. Use <cite>expire_snapshots</cite> to remove older snapshots and their files.</p>
<p>This procedure removes old snapshots and their corresponding files, and never removes files which are required by a non-expired snapshot.</p>
<p>The following arguments are available:</p>
<table class="docutils data align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Argument Name</p></th>
<th class="head"><p>Required</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">schema</span></code></p></td>
<td><p>Yes</p></td>
<td><p>string</p></td>
<td><p>Schema of the table to update</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">table_name</span></code></p></td>
<td><p>Yes</p></td>
<td><p>string</p></td>
<td><p>Name of the table to update</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">older_than</span></code></p></td>
<td></td>
<td><p>timestamp</p></td>
<td><p>Timestamp before which snapshots will be removed (Default: 5 days ago)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">retain_last</span></code></p></td>
<td></td>
<td><p>int</p></td>
<td><p>Number of ancestor snapshots to preserve regardless of older_than
(defaults to 1)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">snapshot_ids</span></code></p></td>
<td></td>
<td><p>array of long</p></td>
<td><p>Array of snapshot IDs to expire</p></td>
</tr>
</tbody>
</table>
<p>Examples:</p>
<ul>
<li><p>Remove snapshots older than a specific day and time, but retain the last 10 snapshots:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">CALL</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">expire_snapshots</span><span class="p">(</span><span class="s1">&#39;schema_name&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;table_name&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="s1">&#39;2023-08-31 00:00:00.000&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span>
</code></pre></div>
</div>
</li>
<li><p>Remove snapshots with snapshot ID 10001 and 10002 (note that these snapshot IDs should not be the current snapshot):</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">CALL</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">expire_snapshots</span><span class="p">(</span><span class="k">schema</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;schema_name&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">table_name</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;table_name&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">snapshot_ids</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nb">ARRAY</span><span class="p">[</span><span class="mi">10001</span><span class="p">,</span><span class="w"> </span><span class="mi">10002</span><span class="p">]);</span>
</code></pre></div>
</div>
</li>
</ul>
<h3 id="remove-orphan-files">Remove Orphan Files<a class="headerlink" href="#remove-orphan-files" title="Link to this heading">¶</a></h3>
<p>Use to remove files which are not referenced in any metadata files of an Iceberg table.</p>
<p>The following arguments are available:</p>
<table class="docutils data align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Argument Name</p></th>
<th class="head"><p>Required</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">schema</span></code></p></td>
<td><p>Yes</p></td>
<td><p>string</p></td>
<td><p>Schema of the table to clean</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">table_name</span></code></p></td>
<td><p>Yes</p></td>
<td><p>string</p></td>
<td><p>Name of the table to clean</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">older_than</span></code></p></td>
<td></td>
<td><p>timestamp</p></td>
<td><p>Remove orphan files created before this timestamp (Default: 3 days ago)</p></td>
</tr>
</tbody>
</table>
<p>Examples:</p>
<ul>
<li><p>Remove any files which are not known to the table <cite>db.sample</cite> and older than specified timestamp:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">CALL</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">remove_orphan_files</span><span class="p">(</span><span class="s1">&#39;db&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;sample&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="s1">&#39;2023-08-31 00:00:00.000&#39;</span><span class="p">);</span>
</code></pre></div>
</div>
</li>
<li><p>Remove any files which are not known to the table <cite>db.sample</cite> and created 3 days ago (by default):</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">CALL</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">remove_orphan_files</span><span class="p">(</span><span class="k">schema</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;db&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">table_name</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;sample&#39;</span><span class="p">);</span>
</code></pre></div>
</div>
</li>
</ul>
<h3 id="fast-forward-branch">Fast Forward Branch<a class="headerlink" href="#fast-forward-branch" title="Link to this heading">¶</a></h3>
<p>This procedure advances the current snapshot of the specified branch to a more recent snapshot from another branch without replaying any intermediate snapshots.
<code class="docutils literal notranslate"><span class="pre">branch</span></code> can be fast-forwarded up to the <code class="docutils literal notranslate"><span class="pre">to</span></code> snapshot if <code class="docutils literal notranslate"><span class="pre">branch</span></code> is an ancestor of <code class="docutils literal notranslate"><span class="pre">to</span></code>.</p>
<p>The following arguments are available:</p>
<table class="docutils data align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Argument Name</p></th>
<th class="head"><p>required</p></th>
<th class="head"><p>type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">schema</span></code></p></td>
<td><p>Yes</p></td>
<td><p>string</p></td>
<td><p>Schema of the table to update</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">table_name</span></code></p></td>
<td><p>Yes</p></td>
<td><p>string</p></td>
<td><p>Name of the table to update</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">branch</span></code></p></td>
<td><p>Yes</p></td>
<td><p>string</p></td>
<td><p>The branch you want to fast-forward</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">to</span></code></p></td>
<td><p>Yes</p></td>
<td><p>string</p></td>
<td><p>The branch you want to fast-forward to</p></td>
</tr>
</tbody>
</table>
<p>Examples:</p>
<ul>
<li><p>Fast-forward the <code class="docutils literal notranslate"><span class="pre">dev</span></code> branch to the latest snapshot of the <code class="docutils literal notranslate"><span class="pre">main</span></code> branch:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">CALL</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">fast_forward</span><span class="p">(</span><span class="s1">&#39;schema_name&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;table_name&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;dev&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;main&#39;</span><span class="p">);</span>
</code></pre></div>
</div>
</li>
<li><p>Given the branch named <code class="docutils literal notranslate"><span class="pre">branch1</span></code> does not exist yet, create a new branch named <code class="docutils literal notranslate"><span class="pre">branch1</span></code>  and set it’s current snapshot equal to the latest snapshot of the <code class="docutils literal notranslate"><span class="pre">main</span></code> branch:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">CALL</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">fast_forward</span><span class="p">(</span><span class="s1">&#39;schema_name&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;table_name&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;branch1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;main&#39;</span><span class="p">);</span>
</code></pre></div>
</div>
</li>
</ul>
<h3 id="statistics-file-cache-invalidation-procedure">Statistics file cache invalidation procedure<a class="headerlink" href="#statistics-file-cache-invalidation-procedure" title="Link to this heading">¶</a></h3>
<ul>
<li><p>Invalidate Statistics file cache:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">CALL</span><span class="w"> </span><span class="o">&lt;</span><span class="k">catalog</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">invalidate_statistics_file_cache</span><span class="p">();</span>
</code></pre></div>
</div>
</li>
</ul>
<h3 id="manifest-file-cache-invalidation-procedure">Manifest file cache invalidation procedure<a class="headerlink" href="#manifest-file-cache-invalidation-procedure" title="Link to this heading">¶</a></h3>
<ul>
<li><p>Invalidate Manifest file cache:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">CALL</span><span class="w"> </span><span class="o">&lt;</span><span class="k">catalog</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">invalidate_manifest_file_cache</span><span class="p">();</span>
</code></pre></div>
</div>
</li>
</ul>
<h3 id="set-table-property">Set Table Property<a class="headerlink" href="#set-table-property" title="Link to this heading">¶</a></h3>
<p>Set from the catalog using the <code class="docutils literal notranslate"><span class="pre">set_table_property</span></code> procedure on the catalog’s <code class="docutils literal notranslate"><span class="pre">system</span></code> schema.</p>
<p>The following arguments are available:</p>
<table class="docutils data align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Argument Name</p></th>
<th class="head"><p>Required</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">schema</span></code></p></td>
<td><p>Yes</p></td>
<td><p>string</p></td>
<td><p>Schema of the table to update</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">table_name</span></code></p></td>
<td><p>Yes</p></td>
<td><p>string</p></td>
<td><p>Name of the table to update</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">key</span></code></p></td>
<td><p>Yes</p></td>
<td><p>string</p></td>
<td><p>Name of the table property</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">value</span></code></p></td>
<td><p>Yes</p></td>
<td><p>string</p></td>
<td><p>Value for the table property</p></td>
</tr>
</tbody>
</table>
<p>Examples:</p>
<ul>
<li><p>Set table property <code class="docutils literal notranslate"><span class="pre">commit.retry.num-retries</span></code> to <code class="docutils literal notranslate"><span class="pre">10</span></code> for a Iceberg table:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">CALL</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">set_table_property</span><span class="p">(</span><span class="s1">&#39;schema_name&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;table_name&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;commit.retry.num-retries&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;10&#39;</span><span class="p">);</span>
</code></pre></div>
</div>
</li>
</ul>
<h3 id="id7">Presto C++ Support<a class="headerlink" href="#id7" title="Link to this heading">¶</a></h3>
<p>All above procedures are supported in Presto C++.</p>
<h2 id="sql-support">SQL Support<a class="headerlink" href="#sql-support" title="Link to this heading">¶</a></h2>
<table class="docutils data align-default">
<thead>
<tr class="row-odd"><th class="head"><p>SQL Operation</p></th>
<th class="head"><p>Presto Java</p></th>
<th class="head"><p>Presto C++</p></th>
<th class="head"><p>Comments</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">SCHEMA</span></code></p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">TABLE</span></code></p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">VIEW</span></code></p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">INSERT</span> <span class="pre">INTO</span></code></p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">TABLE</span> <span class="pre">AS</span> <span class="pre">SELECT</span></code></p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">SELECT</span></code></p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Read is supported in Presto C++ including those with positional delete files.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ALTER</span> <span class="pre">TABLE</span></code></p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ALTER</span> <span class="pre">VIEW</span></code></p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">TRUNCATE</span></code></p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">DELETE</span></code></p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">DROP</span> <span class="pre">TABLE</span></code></p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">DROP</span> <span class="pre">VIEW</span></code></p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">DROP</span> <span class="pre">SCHEMA</span></code></p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">SHOW</span> <span class="pre">CREATE</span> <span class="pre">TABLE</span></code></p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">SHOW</span> <span class="pre">COLUMNS</span></code></p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">DESCRIBE</span></code></p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">UPDATE</span></code></p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
</tbody>
</table>
<p>The Iceberg connector supports querying and manipulating Iceberg tables and schemas
(databases). Here are some examples of the SQL operations supported by Presto:</p>
<h3 id="create-schema">CREATE SCHEMA<a class="headerlink" href="#create-schema" title="Link to this heading">¶</a></h3>
<p>Create a new Iceberg schema named <code class="docutils literal notranslate"><span class="pre">web</span></code> that stores tables in an
S3 bucket named <code class="docutils literal notranslate"><span class="pre">my-bucket</span></code>:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">SCHEMA</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="n">web</span>
<span class="k">WITH</span><span class="w"> </span><span class="p">(</span><span class="k">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;s3://my-bucket/&#39;</span><span class="p">)</span>
</code></pre></div>
</div>
<h3 id="create-table">CREATE TABLE<a class="headerlink" href="#create-table" title="Link to this heading">¶</a></h3>
<p>Create a new Iceberg table named <code class="docutils literal notranslate"><span class="pre">page_views</span></code> in the <code class="docutils literal notranslate"><span class="pre">web</span></code> schema
that is stored using the ORC file format, partitioned by <code class="docutils literal notranslate"><span class="pre">ds</span></code> and
<code class="docutils literal notranslate"><span class="pre">country</span></code>:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="n">web</span><span class="p">.</span><span class="n">page_views</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="n">view_time</span><span class="w"> </span><span class="k">timestamp</span><span class="p">,</span>
<span class="w">  </span><span class="n">user_id</span><span class="w"> </span><span class="nb">bigint</span><span class="p">,</span>
<span class="w">  </span><span class="n">page_url</span><span class="w"> </span><span class="nb">varchar</span><span class="p">,</span>
<span class="w">  </span><span class="n">ds</span><span class="w"> </span><span class="nb">date</span><span class="p">,</span>
<span class="w">  </span><span class="n">country</span><span class="w"> </span><span class="nb">varchar</span>
<span class="p">)</span>
<span class="k">WITH</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="n">format</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;ORC&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="n">partitioning</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ARRAY</span><span class="p">[</span><span class="s1">&#39;ds&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;country&#39;</span><span class="p">]</span>
<span class="p">)</span>
</code></pre></div>
</div>
<p>Create an Iceberg table with Iceberg format version 2 and with commit_retries set to 5:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="n">web</span><span class="p">.</span><span class="n">page_views_v2</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="n">view_time</span><span class="w"> </span><span class="k">timestamp</span><span class="p">,</span>
<span class="w">  </span><span class="n">user_id</span><span class="w"> </span><span class="nb">bigint</span><span class="p">,</span>
<span class="w">  </span><span class="n">page_url</span><span class="w"> </span><span class="nb">varchar</span><span class="p">,</span>
<span class="w">  </span><span class="n">ds</span><span class="w"> </span><span class="nb">date</span><span class="p">,</span>
<span class="w">  </span><span class="n">country</span><span class="w"> </span><span class="nb">varchar</span>
<span class="p">)</span>
<span class="k">WITH</span><span class="w"> </span><span class="p">(</span>
<span class="w">  </span><span class="n">format</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;ORC&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="n">partitioning</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ARRAY</span><span class="p">[</span><span class="s1">&#39;ds&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;country&#39;</span><span class="p">],</span>
<span class="w">  </span><span class="n">format_version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;2&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="n">commit_retries</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span>
<span class="p">)</span>
</code></pre></div>
</div>
<h4 id="partition-column-transform">Partition Column Transform<a class="headerlink" href="#partition-column-transform" title="Link to this heading">¶</a></h4>
<p>Beyond selecting some particular columns for partitioning, you can use the <code class="docutils literal notranslate"><span class="pre">transform</span></code> functions and partition the table
by the transformed value of the column.</p>
<p>Available transforms in the Presto Iceberg connector include:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Bucket</span></code> (partitions data into a specified number of buckets using a hash function)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Truncate</span></code> (partitions the table based on the truncated value of the field and can specify the width of the truncated value)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Identity</span></code> (partitions data using unmodified source value)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Year</span></code> (partitions data using integer value by extracting a date or timestamp year, as years from 1970)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Month</span></code> (partitions data using integer value by extracting a date or timestamp month, as months from 1970-01-01)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Day</span></code> (partitions data using integer value by extracting a date or timestamp day, as days from 1970-01-01)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Hour</span></code> (partitions data using integer value by extracting a timestamp hour, as hours from 1970-01-01 00:00:00)</p></li>
</ul>
<p>Create an Iceberg table partitioned into 8 buckets of equal size ranges:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">players</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">int</span><span class="p">,</span>
<span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="nb">varchar</span><span class="p">,</span>
<span class="w">    </span><span class="n">team</span><span class="w"> </span><span class="nb">varchar</span>
<span class="p">)</span>
<span class="k">WITH</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">format</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;ORC&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="n">partitioning</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ARRAY</span><span class="p">[</span><span class="s1">&#39;bucket(team, 8)&#39;</span><span class="p">]</span>
<span class="p">);</span>
</code></pre></div>
</div>
<p>Create an Iceberg table partitioned by the first letter of the <code class="docutils literal notranslate"><span class="pre">team</span></code> field:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">players</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">int</span><span class="p">,</span>
<span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="nb">varchar</span><span class="p">,</span>
<span class="w">    </span><span class="n">team</span><span class="w"> </span><span class="nb">varchar</span>
<span class="p">)</span>
<span class="k">WITH</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">format</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;ORC&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="n">partitioning</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ARRAY</span><span class="p">[</span><span class="s1">&#39;truncate(team, 1)&#39;</span><span class="p">]</span>
<span class="p">);</span>
</code></pre></div>
</div>
<p>Create an Iceberg table partitioned by <code class="docutils literal notranslate"><span class="pre">ds</span></code>:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">players</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">int</span><span class="p">,</span>
<span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="nb">varchar</span><span class="p">,</span>
<span class="w">    </span><span class="n">team</span><span class="w"> </span><span class="nb">varchar</span><span class="p">,</span>
<span class="w">    </span><span class="n">ds</span><span class="w"> </span><span class="nb">date</span>
<span class="p">)</span>
<span class="k">WITH</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">format</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;ORC&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="n">partitioning</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ARRAY</span><span class="p">[</span><span class="s1">&#39;year(ds)&#39;</span><span class="p">]</span>
<span class="p">);</span>
</code></pre></div>
</div>
<p>Create an Iceberg table partitioned by <code class="docutils literal notranslate"><span class="pre">ts</span></code>:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">players</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">int</span><span class="p">,</span>
<span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="nb">varchar</span><span class="p">,</span>
<span class="w">    </span><span class="n">team</span><span class="w"> </span><span class="nb">varchar</span><span class="p">,</span>
<span class="w">    </span><span class="n">ts</span><span class="w"> </span><span class="k">timestamp</span>
<span class="p">)</span>
<span class="k">WITH</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">format</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;ORC&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="n">partitioning</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ARRAY</span><span class="p">[</span><span class="s1">&#39;hour(ts)&#39;</span><span class="p">]</span>
<span class="p">);</span>
</code></pre></div>
</div>
<h4 id="types-for-partition-transforms">Types for partition transforms<a class="headerlink" href="#types-for-partition-transforms" title="Link to this heading">¶</a></h4>
<p>The list of supported types in Presto for each partition transform is as follows:</p>
<table class="docutils data align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Transform Name</p></th>
<th class="head"><p>Source Types</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Identity</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">boolean</span></code>, <code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">bigint</span></code>, <code class="docutils literal notranslate"><span class="pre">real</span></code>, <code class="docutils literal notranslate"><span class="pre">double</span></code>, <code class="docutils literal notranslate"><span class="pre">decimal</span></code>,
<code class="docutils literal notranslate"><span class="pre">varchar</span></code>, <code class="docutils literal notranslate"><span class="pre">varbinary</span></code>, <code class="docutils literal notranslate"><span class="pre">date</span></code>, <code class="docutils literal notranslate"><span class="pre">time</span></code>, <code class="docutils literal notranslate"><span class="pre">timestamp</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Bucket</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">bigint</span></code>, <code class="docutils literal notranslate"><span class="pre">decimal</span></code>, <code class="docutils literal notranslate"><span class="pre">varchar</span></code>, <code class="docutils literal notranslate"><span class="pre">varbinary</span></code>, <code class="docutils literal notranslate"><span class="pre">date</span></code>,
<code class="docutils literal notranslate"><span class="pre">time</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Truncate</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">bigint</span></code>, <code class="docutils literal notranslate"><span class="pre">decimal</span></code>, <code class="docutils literal notranslate"><span class="pre">varchar</span></code>, <code class="docutils literal notranslate"><span class="pre">varbinary</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Year</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">date</span></code>, <code class="docutils literal notranslate"><span class="pre">timestamp</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Month</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">date</span></code>, <code class="docutils literal notranslate"><span class="pre">timestamp</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Day</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">date</span></code>, <code class="docutils literal notranslate"><span class="pre">timestamp</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Hour</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">timestamp</span></code></p></td>
</tr>
</tbody>
</table>
<h4 id="id8">Presto C++ Support<a class="headerlink" href="#id8" title="Link to this heading">¶</a></h4>
<p>Reads from tables with partition column transforms is supported in Presto C++.</p>
<h3 id="create-view">CREATE VIEW<a class="headerlink" href="#create-view" title="Link to this heading">¶</a></h3>
<p>The Iceberg connector supports creating views in Hive, Glue, REST, and Nessie catalogs.
To create a view named <code class="docutils literal notranslate"><span class="pre">view_page_views</span></code> for the <code class="docutils literal notranslate"><span class="pre">iceberg.web.page_views</span></code> table created in the <a class="reference internal" href="#create-table">CREATE TABLE</a> example:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">VIEW</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="n">web</span><span class="p">.</span><span class="n">view_page_views</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">user_id</span><span class="p">,</span><span class="w"> </span><span class="n">country</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="n">web</span><span class="p">.</span><span class="n">page_views</span><span class="p">;</span>
</code></pre></div>
</div>
<div class="note admonition">
<p class="admonition-title">Note</p>
<p>The Iceberg REST catalog may not support view creation depending on the
type of the backing catalog.</p>
</div>
<h3 id="insert-into">INSERT INTO<a class="headerlink" href="#insert-into" title="Link to this heading">¶</a></h3>
<p>Insert data into the <code class="docutils literal notranslate"><span class="pre">page_views</span></code> table:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="n">web</span><span class="p">.</span><span class="n">page_views</span><span class="w"> </span><span class="k">VALUES</span><span class="p">(</span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="s1">&#39;2023-08-12 03:04:05.321&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;https://example.com&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">current_date</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;country&#39;</span><span class="p">);</span>
</code></pre></div>
</div>
<h3 id="create-table-as-select">CREATE TABLE AS SELECT<a class="headerlink" href="#create-table-as-select" title="Link to this heading">¶</a></h3>
<p>Create a new table <code class="docutils literal notranslate"><span class="pre">page_views_new</span></code> from an existing table <code class="docutils literal notranslate"><span class="pre">page_views</span></code>:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="n">web</span><span class="p">.</span><span class="n">page_views_new</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="n">web</span><span class="p">.</span><span class="n">page_views</span>
</code></pre></div>
</div>
<h3 id="select">SELECT<a class="headerlink" href="#select" title="Link to this heading">¶</a></h3>
<p>SELECT table operations are supported for Iceberg format version 1 and version 2 in the connector:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="n">web</span><span class="p">.</span><span class="n">page_views</span><span class="p">;</span>

<span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="n">web</span><span class="p">.</span><span class="n">page_views_v2</span><span class="p">;</span>
</code></pre></div>
</div>
<h4 id="table-with-delete-files">Table with delete files<a class="headerlink" href="#table-with-delete-files" title="Link to this heading">¶</a></h4>
<p>Iceberg V2 tables support row-level deletion. For more information see
<a class="reference external" href="https://iceberg.apache.org/spec/#row-level-deletes">Row-level deletes</a> in the Iceberg Table Spec.
Presto supports reading delete files, including Position Delete Files and Equality Delete Files.
When reading, Presto merges these delete files to read the latest results.</p>
<h3 id="alter-table">ALTER TABLE<a class="headerlink" href="#alter-table" title="Link to this heading">¶</a></h3>
<p>Alter table operations are supported in the Iceberg connector:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="n">web</span><span class="p">.</span><span class="n">page_views</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="n">zipcode</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">;</span>

<span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="n">web</span><span class="p">.</span><span class="n">page_views</span><span class="w"> </span><span class="k">RENAME</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="n">zipcode</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="k">location</span><span class="p">;</span>

<span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="n">web</span><span class="p">.</span><span class="n">page_views</span><span class="w"> </span><span class="k">DROP</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="k">location</span><span class="p">;</span>
</code></pre></div>
</div>
<p>To add a new column as a partition column, identify the transform functions for the column.
The table is partitioned by the transformed value of the column:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="n">web</span><span class="p">.</span><span class="n">page_views</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="n">zipcode</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="w"> </span><span class="k">WITH</span><span class="w"> </span><span class="p">(</span><span class="n">partitioning</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;identity&#39;</span><span class="p">);</span>

<span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="n">web</span><span class="p">.</span><span class="n">page_views</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="w"> </span><span class="k">WITH</span><span class="w"> </span><span class="p">(</span><span class="n">partitioning</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;truncate(2)&#39;</span><span class="p">);</span>

<span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="n">web</span><span class="p">.</span><span class="n">page_views</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="w"> </span><span class="k">WITH</span><span class="w"> </span><span class="p">(</span><span class="n">partitioning</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;bucket(8)&#39;</span><span class="p">);</span>

<span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="n">web</span><span class="p">.</span><span class="n">page_views</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="n">dt</span><span class="w"> </span><span class="nb">date</span><span class="w"> </span><span class="k">WITH</span><span class="w"> </span><span class="p">(</span><span class="n">partitioning</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;year&#39;</span><span class="p">);</span>

<span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="n">web</span><span class="p">.</span><span class="n">page_views</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="n">ts</span><span class="w"> </span><span class="k">timestamp</span><span class="w"> </span><span class="k">WITH</span><span class="w"> </span><span class="p">(</span><span class="n">partitioning</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;month&#39;</span><span class="p">);</span>

<span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="n">web</span><span class="p">.</span><span class="n">page_views</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="n">dt</span><span class="w"> </span><span class="nb">date</span><span class="w"> </span><span class="k">WITH</span><span class="w"> </span><span class="p">(</span><span class="n">partitioning</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;day&#39;</span><span class="p">);</span>

<span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="n">web</span><span class="p">.</span><span class="n">page_views</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="n">ts</span><span class="w"> </span><span class="k">timestamp</span><span class="w"> </span><span class="k">WITH</span><span class="w"> </span><span class="p">(</span><span class="n">partitioning</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;hour&#39;</span><span class="p">);</span>
</code></pre></div>
</div>
<p>Use <code class="docutils literal notranslate"><span class="pre">ARRAY[...]</span></code> instead of a string to specify multiple partition transforms when adding a column. For example:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="n">web</span><span class="p">.</span><span class="n">page_views</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="w"> </span><span class="k">WITH</span><span class="w"> </span><span class="p">(</span><span class="n">partitioning</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ARRAY</span><span class="p">[</span><span class="s1">&#39;truncate(2)&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;bucket(8)&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;identity&#39;</span><span class="p">]);</span>

<span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="n">web</span><span class="p">.</span><span class="n">page_views</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="n">dt</span><span class="w"> </span><span class="nb">date</span><span class="w"> </span><span class="k">WITH</span><span class="w"> </span><span class="p">(</span><span class="n">partitioning</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ARRAY</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;bucket(16)&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;identity&#39;</span><span class="p">]);</span>
</code></pre></div>
</div>
<p>Some Iceberg table properties can be modified using an ALTER TABLE SET PROPERTIES statement. The modifiable table properties are
<code class="docutils literal notranslate"><span class="pre">commit.retry.num-retries</span></code>, <code class="docutils literal notranslate"><span class="pre">read.split.target-size</span></code>, <code class="docutils literal notranslate"><span class="pre">write.metadata.delete-after-commit.enabled</span></code>, and <code class="docutils literal notranslate"><span class="pre">write.metadata.previous-versions-max</span></code>.</p>
<p>For example, to set <code class="docutils literal notranslate"><span class="pre">commit.retry.num-retries</span></code> to 6 for the table <code class="docutils literal notranslate"><span class="pre">iceberg.web.page_views_v2</span></code>, use:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="n">web</span><span class="p">.</span><span class="n">page_views_v2</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">PROPERTIES</span><span class="w"> </span><span class="p">(</span><span class="ss">&quot;commit.retry.num-retries&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">);</span>
</code></pre></div>
</div>
<p>To set <code class="docutils literal notranslate"><span class="pre">write.metadata.delete-after-commit.enabled</span></code> to true and set <code class="docutils literal notranslate"><span class="pre">write.metadata.previous-versions-max</span></code> to 5, use:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="n">web</span><span class="p">.</span><span class="n">page_views_v2</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">PROPERTIES</span><span class="w"> </span><span class="p">(</span><span class="ss">&quot;write.metadata.delete-after-commit.enabled&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;write.metadata.previous-versions-max&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span>
</code></pre></div>
</div>
<h3 id="alter-view">ALTER VIEW<a class="headerlink" href="#alter-view" title="Link to this heading">¶</a></h3>
<p>Alter view operations to alter the name of an existing view to a new name is supported in the Iceberg connector.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">ALTER</span><span class="w"> </span><span class="k">VIEW</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="n">web</span><span class="p">.</span><span class="n">page_views</span><span class="w"> </span><span class="k">RENAME</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="n">web</span><span class="p">.</span><span class="n">page_new_views</span><span class="p">;</span>
</code></pre></div>
</div>
<h3 id="truncate">TRUNCATE<a class="headerlink" href="#truncate" title="Link to this heading">¶</a></h3>
<p>The Iceberg connector can delete all of the data from tables without
dropping the table from the metadata catalog using <code class="docutils literal notranslate"><span class="pre">TRUNCATE</span> <span class="pre">TABLE</span></code>.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">TRUNCATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">nation</span><span class="p">;</span>
</code></pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>TRUNCATE TABLE;
</code></pre></div>
</div>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nation</span><span class="p">;</span>
</code></pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code> nationkey | name | regionkey | comment
-----------+------+-----------+---------
(0 rows)
</code></pre></div>
</div>
<h3 id="delete">DELETE<a class="headerlink" href="#delete" title="Link to this heading">¶</a></h3>
<p>The Iceberg connector can delete data from tables by using <code class="docutils literal notranslate"><span class="pre">DELETE</span> <span class="pre">FROM</span></code>. For example, to delete from the table <code class="docutils literal notranslate"><span class="pre">lineitem</span></code>:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">lineitem</span><span class="p">;</span>

<span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">lineitem</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">linenumber</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>

<span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">lineitem</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">linenumber</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">)</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">linestatus</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;O&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;F&#39;</span><span class="p">);</span>
</code></pre></div>
</div>
<div class="note admonition">
<p class="admonition-title">Note</p>
<p>Filtered columns only support comparison operators, such as EQUALS, LESS THAN, or LESS THAN EQUALS.</p>
<p>Deletes must only occur on the latest snapshot.</p>
<p>For V1 tables, the Iceberg connector can only delete data in one or more entire
partitions. Columns in the filter must all be identity transformed partition
columns of the target table.</p>
</div>
<h3 id="id9">DROP TABLE<a class="headerlink" href="#id9" title="Link to this heading">¶</a></h3>
<p>Drop the table <code class="docutils literal notranslate"><span class="pre">page_views</span></code></p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="n">web</span><span class="p">.</span><span class="n">page_views</span>
</code></pre></div>
</div>
<ul class="simple">
<li><p>Dropping an Iceberg table with Hive Metastore and Glue catalogs only removes metadata from metastore.</p></li>
<li><p>Dropping an Iceberg table with Hadoop and Nessie catalogs removes all the data and metadata in the table.</p></li>
</ul>
<h3 id="drop-view">DROP VIEW<a class="headerlink" href="#drop-view" title="Link to this heading">¶</a></h3>
<p>Drop the view <code class="docutils literal notranslate"><span class="pre">view_page_views</span></code>:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">DROP</span><span class="w"> </span><span class="k">VIEW</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="n">web</span><span class="p">.</span><span class="n">view_page_views</span><span class="p">;</span>
</code></pre></div>
</div>
<h3 id="drop-schema">DROP SCHEMA<a class="headerlink" href="#drop-schema" title="Link to this heading">¶</a></h3>
<p>Drop the schema <code class="docutils literal notranslate"><span class="pre">iceberg.web</span></code>:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">DROP</span><span class="w"> </span><span class="k">SCHEMA</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="n">web</span>
</code></pre></div>
</div>
<h3 id="show-create-table">SHOW CREATE TABLE<a class="headerlink" href="#show-create-table" title="Link to this heading">¶</a></h3>
<p>Show the SQL statement that creates the specified Iceberg table by using <code class="docutils literal notranslate"><span class="pre">SHOW</span> <span class="pre">CREATE</span> <span class="pre">TABLE</span></code>.</p>
<p>For example, <code class="docutils literal notranslate"><span class="pre">SHOW</span> <span class="pre">CREATE</span> <span class="pre">TABLE</span></code> from the partitioned Iceberg table <code class="docutils literal notranslate"><span class="pre">customer</span></code>:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">SHOW</span><span class="w"> </span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">customer</span><span class="p">;</span>
</code></pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>CREATE TABLE iceberg.tpch_iceberg.customer (
    &quot;custkey&quot; bigint,
    &quot;name&quot; varchar,
    &quot;address&quot; varchar,
    &quot;nationkey&quot; bigint,
    &quot;phone&quot; varchar,
    &quot;acctbal&quot; double,
    &quot;mktsegment&quot; varchar,
    &quot;comment&quot; varchar
)
WITH (
    delete_mode = &#39;copy-on-write&#39;,
    format = &#39;PARQUET&#39;,
    format_version = &#39;2&#39;,
    location = &#39;s3a://tpch-iceberg/customer&#39;,
    partitioning = ARRAY[&#39;mktsegment&#39;]
)
(1 row)
</code></pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">SHOW</span> <span class="pre">CREATE</span> <span class="pre">TABLE</span></code> from the un-partitioned Iceberg table <code class="docutils literal notranslate"><span class="pre">region</span></code>:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">SHOW</span><span class="w"> </span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">region</span><span class="p">;</span>
</code></pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>CREATE TABLE iceberg.tpch_iceberg.region (
    &quot;regionkey&quot; bigint,
    &quot;name&quot; varchar,
    &quot;comment&quot; varchar
)
WITH (
    delete_mode = &#39;copy-on-write&#39;,
    format = &#39;PARQUET&#39;,
    format_version = &#39;2&#39;,
    location = &#39;s3a://tpch-iceberg/region&#39;
)
(1 row)
</code></pre></div>
</div>
<h3 id="show-columns">SHOW COLUMNS<a class="headerlink" href="#show-columns" title="Link to this heading">¶</a></h3>
<p>List the columns in table along with their data type and other attributes by using <code class="docutils literal notranslate"><span class="pre">SHOW</span> <span class="pre">COLUMNS</span></code>.</p>
<p>For example, <code class="docutils literal notranslate"><span class="pre">SHOW</span> <span class="pre">COLUMNS</span></code> from the partitioned Iceberg table <code class="docutils literal notranslate"><span class="pre">customer</span></code>:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">SHOW</span><span class="w"> </span><span class="n">COLUMNS</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">customer</span><span class="p">;</span>
</code></pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>   Column   |  Type   |     Extra     | Comment
------------+---------+---------------+---------
 custkey    | bigint  |               |
 name       | varchar |               |
 address    | varchar |               |
 nationkey  | bigint  |               |
 phone      | varchar |               |
 acctbal    | double  |               |
 mktsegment | varchar | partition key |
 comment    | varchar |               |
 (8 rows)
</code></pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">SHOW</span> <span class="pre">COLUMNS</span></code> from the un-partitioned Iceberg table <code class="docutils literal notranslate"><span class="pre">region</span></code>:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">SHOW</span><span class="w"> </span><span class="n">COLUMNS</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">region</span><span class="p">;</span>
</code></pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>  Column   |  Type   | Extra | Comment
-----------+---------+-------+---------
 regionkey | bigint  |       |
 name      | varchar |       |
 comment   | varchar |       |
 (3 rows)
</code></pre></div>
</div>
<h3 id="describe">DESCRIBE<a class="headerlink" href="#describe" title="Link to this heading">¶</a></h3>
<p>List the columns in table along with their data type and other attributes by using <code class="docutils literal notranslate"><span class="pre">DESCRIBE</span></code>.
<code class="docutils literal notranslate"><span class="pre">DESCRIBE</span></code> is an alias for <code class="docutils literal notranslate"><span class="pre">SHOW</span> <span class="pre">COLUMNS</span></code>.</p>
<p>For example, <code class="docutils literal notranslate"><span class="pre">DESCRIBE</span></code> from the partitioned Iceberg table <code class="docutils literal notranslate"><span class="pre">customer</span></code>:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">DESCRIBE</span><span class="w"> </span><span class="n">customer</span><span class="p">;</span>
</code></pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>   Column   |  Type   |     Extra     | Comment
------------+---------+---------------+---------
 custkey    | bigint  |               |
 name       | varchar |               |
 address    | varchar |               |
 nationkey  | bigint  |               |
 phone      | varchar |               |
 acctbal    | double  |               |
 mktsegment | varchar | partition key |
 comment    | varchar |               |
 (8 rows)
</code></pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">DESCRIBE</span></code> from the un-partitioned Iceberg table <code class="docutils literal notranslate"><span class="pre">region</span></code>:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">DESCRIBE</span><span class="w"> </span><span class="n">region</span><span class="p">;</span>
</code></pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>  Column   |  Type   | Extra | Comment
-----------+---------+-------+---------
 regionkey | bigint  |       |
 name      | varchar |       |
 comment   | varchar |       |
 (3 rows)
</code></pre></div>
</div>
<h3 id="update">UPDATE<a class="headerlink" href="#update" title="Link to this heading">¶</a></h3>
<p>The Iceberg connector supports <a class="reference internal" href="../sql/update.html"><span class="doc">UPDATE</span></a> operations on Iceberg
tables. Only some tables support updates. These tables must be at minimum format
version 2, and the <code class="docutils literal notranslate"><span class="pre">write.update.mode</span></code> must be set to <cite>merge-on-read</cite>.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">UPDATE</span><span class="w"> </span><span class="n">region</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;EU&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">comment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Europe&#39;</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">regionkey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</code></pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>UPDATE: 1 row

Query 20250204_010341_00021_ymwi5, FINISHED, 2 nodes
</code></pre></div>
</div>
<p>The query returns an error if the table does not meet the requirements for
updates.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>Query 20250204_010445_00022_ymwi5 failed: Iceberg table updates require at least format version 2 and update mode must be merge-on-read
</code></pre></div>
</div>
<h2 id="schema-evolution">Schema Evolution<a class="headerlink" href="#schema-evolution" title="Link to this heading">¶</a></h2>
<p>Iceberg and Presto Iceberg connector support in-place table evolution, also known as
schema evolution, such as adding, dropping, and renaming columns. With schema
evolution, users can evolve a table schema with SQL after enabling the Presto
Iceberg connector.</p>
<h3 id="id10">Presto C++ Support<a class="headerlink" href="#id10" title="Link to this heading">¶</a></h3>
<p>Schema evolution is supported in Presto C++.</p>
<h2 id="parquet-writer-version">Parquet Writer Version<a class="headerlink" href="#parquet-writer-version" title="Link to this heading">¶</a></h2>
<p>Presto now supports Parquet writer versions V1 and V2 for the Iceberg catalog.
It can be toggled using the session property <code class="docutils literal notranslate"><span class="pre">parquet_writer_version</span></code> and the config property <code class="docutils literal notranslate"><span class="pre">hive.parquet.writer.version</span></code>.
Valid values for these properties are <code class="docutils literal notranslate"><span class="pre">PARQUET_1_0</span></code> and <code class="docutils literal notranslate"><span class="pre">PARQUET_2_0</span></code>. Default is <code class="docutils literal notranslate"><span class="pre">PARQUET_1_0</span></code>.</p>
<h3 id="id11">Presto C++ Support<a class="headerlink" href="#id11" title="Link to this heading">¶</a></h3>
<blockquote>
<div><p>Reading Parquet data written with Parquet writer version V1 is supported in Presto C++.</p>
</div></blockquote>
<h3 id="example-queries">Example Queries<a class="headerlink" href="#example-queries" title="Link to this heading">¶</a></h3>
<p>Let’s create an Iceberg table named <cite>ctas_nation</cite>, created from the TPCH <cite>nation</cite>
table. The table has four columns: <cite>nationkey</cite>, <cite>name</cite>, <cite>regionkey</cite>, and <cite>comment</cite>.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="n">USE</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="n">tpch</span><span class="p">;</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="n">ctas_nation</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nation</span><span class="p">);</span>
<span class="k">DESCRIBE</span><span class="w"> </span><span class="n">ctas_nation</span><span class="p">;</span>
</code></pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>  Column   |  Type   | Extra | Comment
-----------+---------+-------+---------
 nationkey | bigint  |       |
 name      | varchar |       |
 regionkey | bigint  |       |
 comment   | varchar |       |
(4 rows)
</code></pre></div>
</div>
<p>We can simply add a new column to the Iceberg table by using <cite>ALTER TABLE</cite>
statement. The following query adds a new column named <cite>zipcode</cite> to the table.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">ctas_nation</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="n">zipcode</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">;</span>
<span class="k">DESCRIBE</span><span class="w"> </span><span class="n">ctas_nation</span><span class="p">;</span>
</code></pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>  Column   |  Type   | Extra | Comment
-----------+---------+-------+---------
 nationkey | bigint  |       |
 name      | varchar |       |
 regionkey | bigint  |       |
 comment   | varchar |       |
 zipcode   | varchar |       |
(5 rows)
</code></pre></div>
</div>
<p>We can also rename the new column to another name, <cite>address</cite>:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">ctas_nation</span><span class="w"> </span><span class="k">RENAME</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="n">zipcode</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="n">address</span><span class="p">;</span>
<span class="k">DESCRIBE</span><span class="w"> </span><span class="n">ctas_nation</span><span class="p">;</span>
</code></pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>  Column   |  Type   | Extra | Comment
-----------+---------+-------+---------
 nationkey | bigint  |       |
 name      | varchar |       |
 regionkey | bigint  |       |
 comment   | varchar |       |
 address  | varchar |       |
(5 rows)
</code></pre></div>
</div>
<p>Finally, we can delete the new column. The table columns will be restored to the
original state.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">ctas_nation</span><span class="w"> </span><span class="k">DROP</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="n">address</span><span class="p">;</span>
<span class="k">DESCRIBE</span><span class="w"> </span><span class="n">ctas_nation</span><span class="p">;</span>
</code></pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>  Column   |  Type   | Extra | Comment
-----------+---------+-------+---------
 nationkey | bigint  |       |
 name      | varchar |       |
 regionkey | bigint  |       |
 comment   | varchar |       |
(4 rows)
</code></pre></div>
</div>
<h2 id="time-travel">Time Travel<a class="headerlink" href="#time-travel" title="Link to this heading">¶</a></h2>
<p>Iceberg and Presto Iceberg connector support time travel via table snapshots
identified by unique snapshot IDs. The snapshot IDs are stored in the <code class="docutils literal notranslate"><span class="pre">$snapshots</span></code>
metadata table. You can rollback the state of a table to a previous snapshot ID.
It also supports time travel query using SYSTEM_VERSION (VERSION) and SYSTEM_TIME (TIMESTAMP) options.</p>
<h3 id="example-time-travel-queries">Example Time Travel Queries<a class="headerlink" href="#example-time-travel-queries" title="Link to this heading">¶</a></h3>
<p>Similar to the example queries in <a class="reference internal" href="#schema-evolution">SCHEMA EVOLUTION</a>, create an Iceberg
table named <cite>ctas_nation</cite> from the TPCH <cite>nation</cite> table:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="n">USE</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="n">tpch</span><span class="p">;</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="n">ctas_nation</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nation</span><span class="p">);</span>
<span class="k">DESCRIBE</span><span class="w"> </span><span class="n">ctas_nation</span><span class="p">;</span>
</code></pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>  Column   |  Type   | Extra | Comment
-----------+---------+-------+---------
 nationkey | bigint  |       |
 name      | varchar |       |
 regionkey | bigint  |       |
 comment   | varchar |       |
(4 rows)
</code></pre></div>
</div>
<p>We can find snapshot IDs for the Iceberg table from the <cite>$snapshots</cite> metadata table.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="n">snapshot_id</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="n">tpch</span><span class="p">.</span><span class="ss">&quot;ctas_nation$snapshots&quot;</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">committed_at</span><span class="p">;</span>
</code></pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>     snapshot_id
---------------------
 5837462824399906536
(1 row)
</code></pre></div>
</div>
<p>For now, as we’ve just created the table, there’s only one snapshot ID. Let’s
insert one row into the table and see the change in the snapshot IDs.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">ctas_nation</span><span class="w"> </span><span class="k">VALUES</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;new country&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;comment&#39;</span><span class="p">);</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">snapshot_id</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="n">tpch</span><span class="p">.</span><span class="ss">&quot;ctas_nation$snapshots&quot;</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">committed_at</span><span class="p">;</span>
</code></pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>     snapshot_id
---------------------
 5837462824399906536
 5140039250977437531
(2 rows)
</code></pre></div>
</div>
<p>Now there’s a new snapshot (<cite>5140039250977437531</cite>) created as a new row is
inserted into the table. The new row can be verified by running</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ctas_nation</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;new country&#39;</span><span class="p">;</span>
</code></pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code> nationkey |    name     | regionkey | comment
-----------+-------------+-----------+---------
        25 | new country |         1 | comment
(1 row)
</code></pre></div>
</div>
<p>With the time travel feature, we can rollback to the previous state without the
new row by calling <cite>iceberg.system.rollback_to_snapshot</cite>:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">CALL</span><span class="w"> </span><span class="n">iceberg</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">rollback_to_snapshot</span><span class="p">(</span><span class="s1">&#39;tpch&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;ctas_nation&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5837462824399906536</span><span class="p">);</span>
</code></pre></div>
</div>
<p>Now if we check the table again, we’ll find that the newly inserted row no longer
exists as we’ve rolled back to the previous state.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ctas_nation</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;new country&#39;</span><span class="p">;</span>
</code></pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code> nationkey | name | regionkey | comment
-----------+------+-----------+---------
(0 rows)
</code></pre></div>
</div>
<h3 id="time-travel-using-version-system-version-and-timestamp-system-time">Time Travel using VERSION (SYSTEM_VERSION) and TIMESTAMP (SYSTEM_TIME)<a class="headerlink" href="#time-travel-using-version-system-version-and-timestamp-system-time" title="Link to this heading">¶</a></h3>
<p>Use the Iceberg connector to access the historical data of a table.
You can see how the table looked like at a certain point in time,
even if the data has changed or been deleted since then.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="n">snapshot</span><span class="w"> </span><span class="n">ID</span><span class="w"> </span><span class="mi">5300424205832769799</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">ctas_nation</span><span class="w"> </span><span class="k">VALUES</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;united states&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;comment&#39;</span><span class="p">);</span>

<span class="o">//</span><span class="w"> </span><span class="n">snapshot</span><span class="w"> </span><span class="n">ID</span><span class="w"> </span><span class="mi">6891257133877048303</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">ctas_nation</span><span class="w"> </span><span class="k">VALUES</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;canada&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;comment&#39;</span><span class="p">);</span>

<span class="o">//</span><span class="w"> </span><span class="n">snapshot</span><span class="w"> </span><span class="n">ID</span><span class="w"> </span><span class="mi">705548372863208787</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">ctas_nation</span><span class="w"> </span><span class="k">VALUES</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;mexico&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;comment&#39;</span><span class="p">);</span>

<span class="o">//</span><span class="w"> </span><span class="n">snapshot</span><span class="w"> </span><span class="n">ID</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">first</span><span class="w"> </span><span class="n">record</span>
<span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ctas_nation</span><span class="w"> </span><span class="k">FOR</span><span class="w"> </span><span class="k">VERSION</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">OF</span><span class="w"> </span><span class="mi">5300424205832769799</span><span class="p">;</span>

<span class="o">//</span><span class="w"> </span><span class="n">snapshot</span><span class="w"> </span><span class="n">ID</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">first</span><span class="w"> </span><span class="n">record</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="n">SYSTEM_VERSION</span>
<span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ctas_nation</span><span class="w"> </span><span class="k">FOR</span><span class="w"> </span><span class="n">SYSTEM_VERSION</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">OF</span><span class="w"> </span><span class="mi">5300424205832769799</span><span class="p">;</span>
</code></pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code> nationkey |      name     | regionkey | comment
-----------+---------------+-----------+---------
        10 | united states |         1 | comment
(1 row)
</code></pre></div>
</div>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="n">snapshot</span><span class="w"> </span><span class="n">ID</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">second</span><span class="w"> </span><span class="n">record</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="k">BEFORE</span><span class="w"> </span><span class="n">clause</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">retrieve</span><span class="w"> </span><span class="n">previous</span><span class="w"> </span><span class="k">state</span>
<span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ctas_nation</span><span class="w"> </span><span class="k">FOR</span><span class="w"> </span><span class="n">SYSTEM_VERSION</span><span class="w"> </span><span class="k">BEFORE</span><span class="w"> </span><span class="mi">6891257133877048303</span><span class="p">;</span>
</code></pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code> nationkey |      name     | regionkey | comment
-----------+---------------+-----------+---------
        10 | united states |         1 | comment
(1 row)
</code></pre></div>
</div>
<p>In above example, SYSTEM_VERSION can be used as an alias for VERSION.</p>
<p>You can access the historical data of a table using FOR TIMESTAMP AS OF TIMESTAMP.
The query returns the table’s state using the table snapshot that is closest to the specified timestamp.
In this example, SYSTEM_TIME can be used as an alias for TIMESTAMP.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="k">In</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="n">query</span><span class="p">,</span><span class="w"> </span><span class="k">timestamp</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">matching</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="k">second</span><span class="w"> </span><span class="n">inserted</span><span class="w"> </span><span class="n">record</span><span class="p">.</span>
<span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ctas_nation</span><span class="w"> </span><span class="k">FOR</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">OF</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="s1">&#39;2023-10-17 13:29:46.822 America/Los_Angeles&#39;</span><span class="p">;</span>
<span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ctas_nation</span><span class="w"> </span><span class="k">FOR</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">OF</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="s1">&#39;2023-10-17 13:29:46.822&#39;</span><span class="p">;</span>

<span class="o">//</span><span class="w"> </span><span class="n">Same</span><span class="w"> </span><span class="n">example</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="n">SYSTEM_TIME</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="k">alias</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">TIMESTAMP</span>
<span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ctas_nation</span><span class="w"> </span><span class="k">FOR</span><span class="w"> </span><span class="n">SYSTEM_TIME</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">OF</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="s1">&#39;2023-10-17 13:29:46.822 America/Los_Angeles&#39;</span><span class="p">;</span>
<span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ctas_nation</span><span class="w"> </span><span class="k">FOR</span><span class="w"> </span><span class="n">SYSTEM_TIME</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">OF</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="s1">&#39;2023-10-17 13:29:46.822&#39;</span><span class="p">;</span>
</code></pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code> nationkey |      name     | regionkey | comment
-----------+---------------+-----------+---------
        10 | united states |         1 | comment
        20 | canada        |         2 | comment
(2 rows)
</code></pre></div>
</div>
<div class="note admonition">
<p class="admonition-title">Note</p>
<p>Timestamp without timezone will be parsed and rendered in the session time zone. See <a class="reference external" href="https://prestodb.io/docs/current/language/types.html#timestamp">TIMESTAMP</a>.</p>
</div>
<p>The option following FOR TIMESTAMP AS OF can accept any expression that returns a timestamp or timestamp with time zone value.
For example, <cite>TIMESTAMP ‘2023-10-17 13:29:46.822 America/Los_Angeles’</cite> and <cite>TIMESTAMP ‘2023-10-17 13:29:46.822’</cite> are both valid timestamps. The first specifies the timestamp within the timezone <cite>America/Los_Angeles</cite>. The second will use the timestamp based on the user’s session timezone.
In the following query, the expression CURRENT_TIMESTAMP returns the current timestamp with time zone value.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ctas_nation</span><span class="w"> </span><span class="k">FOR</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">OF</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="p">;</span>
</code></pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code> nationkey |      name     | regionkey | comment
-----------+---------------+-----------+---------
        10 | united states |         1 | comment
        20 | canada        |         2 | comment
        30 | mexico        |         3 | comment
(3 rows)
</code></pre></div>
</div>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="k">In</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="n">query</span><span class="p">,</span><span class="w"> </span><span class="k">timestamp</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">matching</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="k">second</span><span class="w"> </span><span class="n">inserted</span><span class="w"> </span><span class="n">record</span><span class="p">.</span>
<span class="o">//</span><span class="w"> </span><span class="k">BEFORE</span><span class="w"> </span><span class="n">clause</span><span class="w"> </span><span class="k">returns</span><span class="w"> </span><span class="k">first</span><span class="w"> </span><span class="n">record</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">less</span><span class="w"> </span><span class="k">than</span><span class="w"> </span><span class="k">timestamp</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">second</span><span class="w"> </span><span class="n">record</span><span class="p">.</span>
<span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ctas_nation</span><span class="w"> </span><span class="k">FOR</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">BEFORE</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="s1">&#39;2023-10-17 13:29:46.822 America/Los_Angeles&#39;</span><span class="p">;</span>
<span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ctas_nation</span><span class="w"> </span><span class="k">FOR</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">BEFORE</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="s1">&#39;2023-10-17 13:29:46.822&#39;</span><span class="p">;</span>
</code></pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code> nationkey |      name     | regionkey | comment
-----------+---------------+-----------+---------
        10 | united states |         1 | comment
(1 row)
</code></pre></div>
</div>
<h3 id="querying-branches-and-tags">Querying branches and tags<a class="headerlink" href="#querying-branches-and-tags" title="Link to this heading">¶</a></h3>
<p>Iceberg supports branches and tags which are named references to snapshots.</p>
<p>Query Iceberg table by specifying the branch name:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nation</span><span class="w"> </span><span class="k">FOR</span><span class="w"> </span><span class="n">SYSTEM_VERSION</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">OF</span><span class="w"> </span><span class="s1">&#39;testBranch&#39;</span><span class="p">;</span>
</code></pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code> nationkey |      name     | regionkey | comment
-----------+---------------+-----------+---------
        10 | united states |         1 | comment
        20 | canada        |         2 | comment
        30 | mexico        |         3 | comment
(3 rows)
</code></pre></div>
</div>
<p>Query Iceberg table by specifying the tag name:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">nation</span><span class="w"> </span><span class="k">FOR</span><span class="w"> </span><span class="n">SYSTEM_VERSION</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">OF</span><span class="w"> </span><span class="s1">&#39;testTag&#39;</span><span class="p">;</span>
</code></pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code> nationkey |      name     | regionkey | comment
-----------+---------------+-----------+---------
        10 | united states |         1 | comment
        20 | canada        |         2 | comment
(3 rows)
</code></pre></div>
</div>
<h3 id="id12">Presto C++ Support<a class="headerlink" href="#id12" title="Link to this heading">¶</a></h3>
<p>Time travel queries are supported in Presto C++.</p>
<h2 id="type-mapping">Type mapping<a class="headerlink" href="#type-mapping" title="Link to this heading">¶</a></h2>
<p>PrestoDB and Iceberg have data types not supported by the other. When using Iceberg to read or write data, Presto changes
each Iceberg data type to the corresponding Presto data type, and from each Presto data type to the comparable Iceberg data type.
The following tables detail the specific type maps between PrestoDB and Iceberg.</p>
<h3 id="iceberg-to-prestodb-type-mapping">Iceberg to PrestoDB type mapping<a class="headerlink" href="#iceberg-to-prestodb-type-mapping" title="Link to this heading">¶</a></h3>
<p>Map of Iceberg types to the relevant PrestoDB types:</p>
<table class="docutils data align-default" id="id13">
<caption><span class="caption-text">Iceberg to PrestoDB type mapping</span><a class="headerlink" href="#id13" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 50.0%" />
<col style="width: 50.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Iceberg type</p></th>
<th class="head"><p>PrestoDB type</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">BOOLEAN</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BOOLEAN</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">INTEGER</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">INTEGER</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">LONG</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">FLOAT</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">REAL</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">DOUBLE</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DOUBLE</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">DECIMAL</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DECIMAL</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">STRING</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">VARCHAR</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">BINARY</span></code>, <code class="docutils literal notranslate"><span class="pre">FIXED</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">VARBINARY</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">DATE</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DATE</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">TIME</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">TIME</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">TIMESTAMP</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">TIMESTAMP</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">TIMESTAMP</span> <span class="pre">TZ</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">TIMESTAMP</span> <span class="pre">WITH</span> <span class="pre">TIME</span> <span class="pre">ZONE</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">UUID</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">UUID</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">LIST</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ARRAY</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MAP</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">MAP</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">STRUCT</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ROW</span></code></p></td>
</tr>
</tbody>
</table>
<p>No other types are supported.</p>
<h3 id="prestodb-to-iceberg-type-mapping">PrestoDB to Iceberg type mapping<a class="headerlink" href="#prestodb-to-iceberg-type-mapping" title="Link to this heading">¶</a></h3>
<p>Map of PrestoDB types to the relevant Iceberg types:</p>
<table class="docutils data align-default" id="id14">
<caption><span class="caption-text">PrestoDB to Iceberg type mapping</span><a class="headerlink" href="#id14" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 50.0%" />
<col style="width: 50.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>PrestoDB type</p></th>
<th class="head"><p>Iceberg type</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">BOOLEAN</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BOOLEAN</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">INTEGER</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">INTEGER</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">LONG</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">REAL</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">FLOAT</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">DOUBLE</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DOUBLE</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">DECIMAL</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DECIMAL</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">VARCHAR</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">STRING</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">VARBINARY</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BINARY</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">DATE</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DATE</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">TIME</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">TIME</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">TIMESTAMP</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">TIMESTAMP</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">TIMESTAMP</span> <span class="pre">WITH</span> <span class="pre">TIME</span> <span class="pre">ZONE</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">TIMESTAMP</span> <span class="pre">TZ</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">UUID</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">UUID</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ARRAY</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">LIST</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MAP</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">MAP</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ROW</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">STRUCT</span></code></p></td>
</tr>
</tbody>
</table>
<p>No other types are supported.</p>
<h2 id="sorted-tables">Sorted Tables<a class="headerlink" href="#sorted-tables" title="Link to this heading">¶</a></h2>
<p>The Iceberg connector supports the creation of sorted tables.
Data in the Iceberg table is sorted as each file is written.</p>
<p>Sorted Iceberg tables can decrease query execution time in many cases; but query times can also depend on the query shape and cluster configuration.
Sorting is particularly beneficial when the sorted columns have a
high cardinality and are used as a filter for selective reads.</p>
<p>Configure sort order with the <code class="docutils literal notranslate"><span class="pre">sorted_by</span></code> table property to specify an array of
one or more columns to use for sorting.
The following example creates the table with the <code class="docutils literal notranslate"><span class="pre">sorted_by</span></code> property, and sorts the file based
on the field <code class="docutils literal notranslate"><span class="pre">join_date</span></code>. The default sort direction is ASC, with null values ordered as NULLS FIRST.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>CREATE TABLE emp.employees.employee (
    emp_id BIGINT,
    emp_name VARCHAR,
    join_date DATE,
    country VARCHAR)
WITH (
    sorted_by = ARRAY[&#39;join_date&#39;]
)
</code></pre></div>
</div>
<p>Explicitly configure sort directions or null ordering using the following example:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">emp</span><span class="p">.</span><span class="n">employees</span><span class="p">.</span><span class="n">employee</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">emp_id</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">,</span>
<span class="w">    </span><span class="n">emp_name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="n">join_date</span><span class="w"> </span><span class="nb">DATE</span><span class="p">,</span>
<span class="w">    </span><span class="n">country</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">)</span>
<span class="k">WITH</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">sorted_by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ARRAY</span><span class="p">[</span><span class="s1">&#39;join_date DESC NULLS FIRST&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;emp_id ASC NULLS LAST&#39;</span><span class="p">]</span>
<span class="p">)</span>
</code></pre></div>
</div>
<p>Sorting can be combined with partitioning on the same column. For example:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">emp</span><span class="p">.</span><span class="n">employees</span><span class="p">.</span><span class="n">employee</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">emp_id</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">,</span>
<span class="w">    </span><span class="n">emp_name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="n">join_date</span><span class="w"> </span><span class="nb">DATE</span><span class="p">,</span>
<span class="w">    </span><span class="n">country</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">)</span>
<span class="k">WITH</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">partitioning</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ARRAY</span><span class="p">[</span><span class="s1">&#39;month(join_date)&#39;</span><span class="p">],</span>
<span class="w">    </span><span class="n">sorted_by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ARRAY</span><span class="p">[</span><span class="s1">&#39;join_date&#39;</span><span class="p">]</span>
<span class="p">)</span>
</code></pre></div>
</div>
<p>Sort order does not support transforms. The following transforms are not supported:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span><code>bucket(n, column)
truncate(column, n)
year(column)
month(column)
day(column)
hour(column)
</code></pre></div>
</div>
<p>For example:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">emp</span><span class="p">.</span><span class="n">employees</span><span class="p">.</span><span class="n">employee</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">emp_id</span><span class="w"> </span><span class="nb">BIGINT</span><span class="p">,</span>
<span class="w">    </span><span class="n">emp_name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">,</span>
<span class="w">    </span><span class="n">join_date</span><span class="w"> </span><span class="nb">DATE</span><span class="p">,</span>
<span class="w">    </span><span class="n">country</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">)</span>
<span class="k">WITH</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">sorted_by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ARRAY</span><span class="p">[</span><span class="s1">&#39;month(join_date)&#39;</span><span class="p">]</span>
<span class="p">)</span>
</code></pre></div>
</div>
<p>If a user creates a table externally with non-identity sort columns and then inserts data, the following warning message will be shown.
<code class="docutils literal notranslate"><span class="pre">Iceberg</span> <span class="pre">table</span> <span class="pre">sort</span> <span class="pre">order</span> <span class="pre">has</span> <span class="pre">sort</span> <span class="pre">fields</span> <span class="pre">of</span> <span class="pre">&lt;X&gt;,</span> <span class="pre">&lt;Y&gt;,</span> <span class="pre">...</span> <span class="pre">which</span> <span class="pre">are</span> <span class="pre">not</span> <span class="pre">currently</span> <span class="pre">supported</span> <span class="pre">by</span> <span class="pre">Presto</span></code></p>








  
  



  




                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  
  
  <div class="md-footer-meta md-typeset">
    
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-footer-copyright__highlight">
        &#169; Copyright The Presto Foundation. All rights reserved. Presto is a registered trademark of LF Projects, LLC.
        
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/prestodb/presto" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
    
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["toc.follow", "toc.sticky", "content.code.copy"], "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
      
        <script src="../_static/sphinx_immaterial_theme.32136f45f91ae6956.min.js?v=a7a9472a"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=f281be69"></script>
    
  </body>
</html>